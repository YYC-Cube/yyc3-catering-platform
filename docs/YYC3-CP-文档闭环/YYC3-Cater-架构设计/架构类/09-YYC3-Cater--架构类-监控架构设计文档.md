---

**@file**ï¼šYYCÂ³-ç›‘æ§æ¶æ„è®¾è®¡æ–‡æ¡£
**@description**ï¼šYYCÂ³é¤é¥®è¡Œä¸šæ™ºèƒ½åŒ–å¹³å°çš„ç›‘æ§æ¶æ„è®¾è®¡æ–‡æ¡£ï¼ŒåŒ…å«ç›‘æ§æ¶æ„è®¾è®¡ã€ç›‘æ§æŒ‡æ ‡ã€å‘Šè­¦è§„åˆ™ã€æ—¥å¿—æ”¶é›†ã€é“¾è·¯è¿½è¸ªç­‰æ ¸å¿ƒå†…å®¹
**@author**ï¼šYYCÂ³
**@version**ï¼šv1.0.0
**@created**ï¼š2025-01-30
**@updated**ï¼š2025-01-30
**@status**ï¼špublished
**@tags**ï¼šæ¶æ„è®¾è®¡,YYCÂ³,ç³»ç»Ÿæ¶æ„

---
# ğŸ”– YYCÂ³ ç›‘æ§æ¶æ„è®¾è®¡æ–‡æ¡£

> ***YanYuCloudCube***
> **æ ‡è¯­**ï¼šè¨€å¯è±¡é™ | è¯­æ¢æœªæ¥
> ***Words Initiate Quadrants, Language Serves as Core for the Future***
> **æ ‡è¯­**ï¼šä¸‡è±¡å½’å…ƒäºäº‘æ¢ | æ·±æ ˆæ™ºå¯æ–°çºªå…ƒ
> ***All things converge in the cloud pivot; Deep stacks ignite a new era of intelligence***

---

## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯

| å±æ€§ | å†…å®¹ |
|------|------|
| **æ–‡æ¡£æ ‡é¢˜** | YYCÂ³ ç›‘æ§æ¶æ„è®¾è®¡æ–‡æ¡£ |
| **æ–‡æ¡£ç±»å‹** | æ¶æ„è®¾è®¡æ–‡æ¡£ |
| **æ‰€å±é˜¶æ®µ** | ç³»ç»Ÿæ¶æ„è®¾è®¡ |
| **éµå¾ªè§„èŒƒ** | YYCÂ³ å›¢é˜Ÿæ ‡å‡†åŒ–è§„èŒƒ v1.0.0 |
| **ç‰ˆæœ¬å·** | v1.0.0 |
| **åˆ›å»ºæ—¥æœŸ** | 2025-01-30 |
| **ä½œè€…** | YYCÂ³ Team |
| **æ›´æ–°æ—¥æœŸ** | 2025-01-30 |

---

## ğŸ“‘ ç›®å½•

1. [ç›‘æ§æ¶æ„æ¦‚è¿°](#1-ç›‘æ§æ¶æ„æ¦‚è¿°)
2. [æŒ‡æ ‡ç›‘æ§](#2-æŒ‡æ ‡ç›‘æ§)
3. [æ—¥å¿—ç›‘æ§](#3-æ—¥å¿—ç›‘æ§)
4. [é“¾è·¯è¿½è¸ª](#4-é“¾è·¯è¿½è¸ª)
5. [å‘Šè­¦ç³»ç»Ÿ](#5-å‘Šè­¦ç³»ç»Ÿ)
6. [æ€§èƒ½ç›‘æ§](#6-æ€§èƒ½ç›‘æ§)
7. [ä¸šåŠ¡ç›‘æ§](#7-ä¸šåŠ¡ç›‘æ§)
8. [ç›‘æ§æœ€ä½³å®è·µ](#8-ç›‘æ§æœ€ä½³å®è·µ)

---

## 1. æ¦‚è¿°

### 1.1 è®¾è®¡ç›®æ ‡

æœ¬æ¶æ„è®¾è®¡æ–‡æ¡£æ—¨åœ¨ä¸ºYYCÂ³é¤é¥®è¡Œä¸šæ™ºèƒ½åŒ–å¹³å°æä¾›æ¸…æ™°ã€å®Œæ•´çš„æŠ€æœ¯æ¶æ„æŒ‡å¯¼ã€‚ä¸»è¦ç›®æ ‡åŒ…æ‹¬ï¼š

- **å¯æ‰©å±•æ€§**ï¼šæ”¯æŒä¸šåŠ¡å¿«é€Ÿæ‰©å±•ï¼Œæ¨¡å—åŒ–è®¾è®¡ä¾¿äºåŠŸèƒ½è¿­ä»£
- **é«˜æ€§èƒ½**ï¼šä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½ï¼Œç¡®ä¿é«˜å¹¶å‘åœºæ™¯ä¸‹çš„ç¨³å®šè¿è¡Œ
- **é«˜å¯ç”¨æ€§**ï¼šå®ç°ç³»ç»Ÿé«˜å¯ç”¨ï¼Œæ•…éšœè‡ªåŠ¨æ¢å¤ï¼Œä¿éšœä¸šåŠ¡è¿ç»­æ€§
- **å®‰å…¨æ€§**ï¼šå»ºç«‹å®Œå–„çš„å®‰å…¨ä½“ç³»ï¼Œä¿æŠ¤æ•°æ®å’Œç³»ç»Ÿå®‰å…¨
- **æ˜“ç»´æŠ¤æ€§**ï¼šä»£ç ç»“æ„æ¸…æ™°ï¼Œæ–‡æ¡£å®Œå–„ï¼Œä¾¿äºå›¢é˜Ÿåä½œå’Œç»´æŠ¤

é€šè¿‡æœ¬æ¶æ„è®¾è®¡ï¼Œç¡®ä¿å¹³å°èƒ½å¤Ÿæ»¡è¶³å½“å‰ä¸šåŠ¡éœ€æ±‚ï¼Œå¹¶ä¸ºæœªæ¥çš„å‘å±•å¥ å®šåšå®åŸºç¡€ã€‚

### 1.2 è®¾è®¡åŸåˆ™

æ¶æ„è®¾è®¡éµå¾ªä»¥ä¸‹æ ¸å¿ƒåŸåˆ™ï¼š

- **å•ä¸€èŒè´£åŸåˆ™**ï¼šæ¯ä¸ªæ¨¡å—åªè´Ÿè´£ä¸€ä¸ªæ˜ç¡®çš„ä¸šåŠ¡åŠŸèƒ½
- **å¼€é—­åŸåˆ™**ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼Œä¾¿äºåŠŸèƒ½æ‰©å±•
- **ä¾èµ–å€’ç½®åŸåˆ™**ï¼šé«˜å±‚æ¨¡å—ä¸ä¾èµ–ä½å±‚æ¨¡å—ï¼Œéƒ½ä¾èµ–æŠ½è±¡
- **æ¥å£éš”ç¦»åŸåˆ™**ï¼šä½¿ç”¨ç»†ç²’åº¦çš„æ¥å£ï¼Œé¿å…æ¥å£æ±¡æŸ“
- **æœ€å°‘çŸ¥è¯†åŸåˆ™**ï¼šæ¨¡å—é—´æœ€å°åŒ–ä¾èµ–ï¼Œé™ä½è€¦åˆåº¦

åŒæ—¶éµå¾ªYYCÂ³ã€Œäº”é«˜äº”æ ‡äº”åŒ–ã€æ ¸å¿ƒç†å¿µï¼š
- **äº”é«˜**ï¼šé«˜å¯ç”¨ã€é«˜æ€§èƒ½ã€é«˜å®‰å…¨ã€é«˜æ‰©å±•ã€é«˜å¯ç»´æŠ¤
- **äº”æ ‡**ï¼šæ ‡å‡†åŒ–ã€è§„èŒƒåŒ–ã€è‡ªåŠ¨åŒ–ã€æ™ºèƒ½åŒ–ã€å¯è§†åŒ–
- **äº”åŒ–**ï¼šæµç¨‹åŒ–ã€æ–‡æ¡£åŒ–ã€å·¥å…·åŒ–ã€æ•°å­—åŒ–ã€ç”Ÿæ€åŒ–

### 1.3 æŠ€æœ¯é€‰å‹

æŠ€æœ¯æ ˆé€‰æ‹©åŸºäºä»¥ä¸‹è€ƒè™‘ï¼š

**å‰ç«¯æŠ€æœ¯æ ˆ**
- React 18+ï¼šé‡‡ç”¨ç°ä»£åŒ–å‰ç«¯æ¡†æ¶ï¼Œç»„ä»¶åŒ–å¼€å‘
- TypeScript 5.0+ï¼šç±»å‹å®‰å…¨ï¼Œæé«˜ä»£ç è´¨é‡
- Next.js 14+ï¼šSSR/SSGæ”¯æŒï¼Œä¼˜åŒ–SEOå’Œæ€§èƒ½
- Tailwind CSSï¼šåŸå­åŒ–CSSï¼Œå¿«é€Ÿæ„å»ºUI

**åç«¯æŠ€æœ¯æ ˆ**
- Node.js 18+ï¼šé«˜æ€§èƒ½JavaScriptè¿è¡Œæ—¶
- Express/Fastifyï¼šè½»é‡çº§Webæ¡†æ¶
- PostgreSQL 15+ï¼šå…³ç³»å‹æ•°æ®åº“ï¼ŒACIDä¿è¯
- Redis 7+ï¼šç¼“å­˜å’Œä¼šè¯å­˜å‚¨

**åŸºç¡€è®¾æ–½**
- Dockerï¼šå®¹å™¨åŒ–éƒ¨ç½²ï¼Œç¯å¢ƒä¸€è‡´æ€§
- Kubernetesï¼šå®¹å™¨ç¼–æ’ï¼Œè‡ªåŠ¨åŒ–è¿ç»´
- Nginxï¼šåå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡
- Prometheus + Grafanaï¼šç›‘æ§å’Œå‘Šè­¦

**å¼€å‘å·¥å…·**
- Gitï¼šç‰ˆæœ¬æ§åˆ¶
- ESLint + Prettierï¼šä»£ç è§„èŒƒ
- Jest + Vitestï¼šå•å…ƒæµ‹è¯•
- GitHub Actionsï¼šCI/CDè‡ªåŠ¨åŒ–

## 2. æ¶æ„è®¾è®¡

### 2.1 æ•´ä½“æ¶æ„

YYCÂ³é¤é¥®è¡Œä¸šæ™ºèƒ½åŒ–å¹³å°é‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œä»ä¸Šåˆ°ä¸‹åˆ†ä¸ºä»¥ä¸‹å±‚æ¬¡ï¼š

**è¡¨ç°å±‚ï¼ˆPresentation Layerï¼‰**
- Webå‰ç«¯ï¼šReact + Next.jsæ„å»ºçš„å•é¡µåº”ç”¨
- ç§»åŠ¨ç«¯ï¼šå“åº”å¼è®¾è®¡ï¼Œæ”¯æŒå¤šè®¾å¤‡è®¿é—®
- ç®¡ç†åå°ï¼šç‹¬ç«‹çš„ç®¡ç†ç•Œé¢

**åº”ç”¨å±‚ï¼ˆApplication Layerï¼‰**
- APIç½‘å…³ï¼šç»Ÿä¸€å…¥å£ï¼Œè·¯ç”±åˆ†å‘
- ä¸šåŠ¡æœåŠ¡ï¼šè®¢å•ã€ç”¨æˆ·ã€å•†å“ç­‰æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
- è®¤è¯æˆæƒï¼šJWTè®¤è¯ï¼ŒRBACæƒé™æ§åˆ¶

**é¢†åŸŸå±‚ï¼ˆDomain Layerï¼‰**
- é¢†åŸŸæ¨¡å‹ï¼šæ ¸å¿ƒä¸šåŠ¡å®ä½“å’Œè§„åˆ™
- é¢†åŸŸæœåŠ¡ï¼šå¤æ‚ä¸šåŠ¡é€»è¾‘å°è£…
- ä»“å‚¨æ¥å£ï¼šæ•°æ®è®¿é—®æŠ½è±¡

**åŸºç¡€è®¾æ–½å±‚ï¼ˆInfrastructure Layerï¼‰**
- æ•°æ®åº“ï¼šPostgreSQLä¸»ä»æ¶æ„
- ç¼“å­˜ï¼šRedisé›†ç¾¤
- æ¶ˆæ¯é˜Ÿåˆ—ï¼šRabbitMQ/Kafka
- æ–‡ä»¶å­˜å‚¨ï¼šOSS/MinIO

**è·¨å±‚å…³æ³¨ç‚¹**
- æ—¥å¿—ç›‘æ§ï¼šELK Stack
- é…ç½®ç®¡ç†ï¼šApollo/Nacos
- æœåŠ¡å‘ç°ï¼šConsul/Eureka
- é“¾è·¯è¿½è¸ªï¼šJaeger/SkyWalking

### 2.2 æ¨¡å—åˆ’åˆ†

ç³»ç»ŸæŒ‰ç…§ä¸šåŠ¡é¢†åŸŸåˆ’åˆ†ä¸ºä»¥ä¸‹æ ¸å¿ƒæ¨¡å—ï¼š

**ç”¨æˆ·æ¨¡å—ï¼ˆUser Moduleï¼‰**
- ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€è®¤è¯
- ç”¨æˆ·ä¿¡æ¯ç®¡ç†
- æƒé™å’Œè§’è‰²ç®¡ç†

**å•†å“æ¨¡å—ï¼ˆProduct Moduleï¼‰**
- å•†å“ä¿¡æ¯ç®¡ç†
- å•†å“åˆ†ç±»å’Œæ ‡ç­¾
- åº“å­˜ç®¡ç†

**è®¢å•æ¨¡å—ï¼ˆOrder Moduleï¼‰**
- è®¢å•åˆ›å»ºå’Œæ”¯ä»˜
- è®¢å•çŠ¶æ€æµè½¬
- è®¢å•æŸ¥è¯¢å’Œç»Ÿè®¡

**æ”¯ä»˜æ¨¡å—ï¼ˆPayment Moduleï¼‰**
- æ”¯ä»˜æ¥å£é›†æˆ
- æ”¯ä»˜çŠ¶æ€åŒæ­¥
- é€€æ¬¾å¤„ç†

**è¥é”€æ¨¡å—ï¼ˆMarketing Moduleï¼‰**
- ä¼˜æƒ åˆ¸ç®¡ç†
- ä¿ƒé”€æ´»åŠ¨
- ä¼šå‘˜ç§¯åˆ†

**æŠ¥è¡¨æ¨¡å—ï¼ˆReport Moduleï¼‰**
- é”€å”®æŠ¥è¡¨
- æ•°æ®åˆ†æ
- å¯è§†åŒ–å±•ç¤º

**ç³»ç»Ÿæ¨¡å—ï¼ˆSystem Moduleï¼‰**
- é…ç½®ç®¡ç†
- æ—¥å¿—ç®¡ç†
- ç›‘æ§å‘Šè­¦

### 2.3 æ•°æ®æµå‘

## 3. æŠ€æœ¯å®ç°

### 3.1 æ ¸å¿ƒæŠ€æœ¯

### 3.2 å…³é”®ç®—æ³•

### 3.3 æ€§èƒ½ä¼˜åŒ–

## 4. æ¥å£è®¾è®¡

### 4.1 APIæ¥å£

### 4.2 æ•°æ®æ¥å£

### 4.3 æ¶ˆæ¯æ¥å£

## 5. éƒ¨ç½²æ–¹æ¡ˆ

### 5.1 éƒ¨ç½²æ¶æ„

### 5.2 é…ç½®ç®¡ç†

### 5.3 ç›‘æ§å‘Šè­¦

## 6. é™„å½•

### 6.1 æœ¯è¯­è¡¨

### 6.2 å‚è€ƒèµ„æ–™

## 1. ç›‘æ§æ¶æ„æ¦‚è¿°

### 1.1 æ¶æ„ç®€ä»‹

YYCÂ³ ç›‘æ§æ¶æ„åŸºäºå¯è§‚æµ‹æ€§ä¸‰å¤§æ”¯æŸ±ï¼ˆæŒ‡æ ‡ã€æ—¥å¿—ã€é“¾è·¯è¿½è¸ªï¼‰ï¼Œæ„å»ºå…¨æ–¹ä½ã€å¤šç»´åº¦çš„ç›‘æ§ä½“ç³»ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šè¿è¡Œå’Œå¿«é€Ÿæ•…éšœå®šä½ã€‚

### 1.2 ç›‘æ§å±‚æ¬¡

```
åŸºç¡€è®¾æ–½å±‚
  â”œâ”€â”€ æœåŠ¡å™¨ç›‘æ§ (CPU, å†…å­˜, ç£ç›˜, ç½‘ç»œ)
  â”œâ”€â”€ å®¹å™¨ç›‘æ§ (Pod, Node, Cluster)
  â””â”€â”€ æ•°æ®åº“ç›‘æ§ (MySQL, Redis, MongoDB)

åº”ç”¨å±‚
  â”œâ”€â”€ åº”ç”¨æ€§èƒ½ç›‘æ§ (APM)
  â”œâ”€â”€ æ¥å£ç›‘æ§ (HTTP, gRPC, WebSocket)
  â””â”€â”€ æœåŠ¡ç›‘æ§ (å¾®æœåŠ¡, æ¶ˆæ¯é˜Ÿåˆ—)

ä¸šåŠ¡å±‚
  â”œâ”€â”€ ä¸šåŠ¡æŒ‡æ ‡ç›‘æ§ (è®¢å•, ç”¨æˆ·, æ”¶å…¥)
  â”œâ”€â”€ ç”¨æˆ·ä½“éªŒç›‘æ§ (é¡µé¢åŠ è½½, äº¤äº’å“åº”)
  â””â”€â”€ è½¬åŒ–æ¼æ–—ç›‘æ§ (æ³¨å†Œ, ä¸‹å•, æ”¯ä»˜)
```

### 1.3 ç›‘æ§åŸåˆ™

- **å…¨é¢æ€§**ï¼šè¦†ç›–æ‰€æœ‰å…³é”®ç»„ä»¶å’Œä¸šåŠ¡æµç¨‹
- **å®æ—¶æ€§**ï¼šå®æ—¶é‡‡é›†å’Œå±•ç¤ºç›‘æ§æ•°æ®
- **å¯æ“ä½œæ€§**ï¼šå‘Šè­¦ä¿¡æ¯æ¸…æ™°æ˜ç¡®ï¼Œä¾¿äºå¿«é€Ÿå“åº”
- **å¯æ‰©å±•æ€§**ï¼šæ”¯æŒæ–°å¢ç›‘æ§æŒ‡æ ‡å’Œå‘Šè­¦è§„åˆ™
- **æˆæœ¬æ•ˆç›Š**ï¼šåœ¨æ»¡è¶³ç›‘æ§éœ€æ±‚çš„å‰æä¸‹æ§åˆ¶æˆæœ¬

---

## 2. æŒ‡æ ‡ç›‘æ§

### 2.1 Prometheus é…ç½®

#### 2.1.1 å…¨å±€é…ç½®

```yaml
# === prometheus.yml ===
global:
  scrape_interval: 15s
  evaluation_interval: 15s
  external_labels:
    cluster: 'yyc3-production'
    environment: 'production'

# å‘Šè­¦è§„åˆ™æ–‡ä»¶
rule_files:
  - '/etc/prometheus/rules/*.yml'

# æŠ“å–é…ç½®
scrape_configs:
  # Prometheus è‡ªèº«ç›‘æ§
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  # Kubernetes Pods ç›‘æ§
  - job_name: 'kubernetes-pods'
    kubernetes_sd_configs:
      - role: pod
    relabel_configs:
      - source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_scrape]
        action: keep
        regex: true
      - source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_path]
        action: replace
        target_label: __metrics_path__
        regex: (.+)
      - source_labels: [__address__, __meta_kubernetes_pod_annotation_prometheus_io_port]
        action: replace
        regex: ([^:]+)(?::\d+)?;(\d+)
        replacement: $1:$2
        target_label: __address__
      - action: labelmap
        regex: __meta_kubernetes_pod_label_(.+)
      - source_labels: [__meta_kubernetes_namespace]
        action: replace
        target_label: kubernetes_namespace
      - source_labels: [__meta_kubernetes_pod_name]
        action: replace
        target_label: kubernetes_pod_name

  # Kubernetes Nodes ç›‘æ§
  - job_name: 'kubernetes-nodes'
    kubernetes_sd_configs:
      - role: node
    relabel_configs:
      - source_labels: [__address__]
        regex: '(.*):10250'
        replacement: '${1}:9100'
        target_label: __address__

  # åº”ç”¨æœåŠ¡ç›‘æ§
  - job_name: 'yyc3-backend'
    static_configs:
      - targets: ['yyc3-backend-service:3000']
    metrics_path: '/metrics'

  - job_name: 'yyc3-frontend'
    static_configs:
      - targets: ['yyc3-frontend-service:80']
    metrics_path: '/metrics'
```

### 2.2 åº”ç”¨æŒ‡æ ‡

#### 2.2.1 HTTP æŒ‡æ ‡

```typescript
/**
 * @file HTTP æŒ‡æ ‡æ”¶é›†
 * @description æ”¶é›† HTTP è¯·æ±‚ç›¸å…³æŒ‡æ ‡
 * @module metrics/http
 * @author YYCÂ³
 * @version 1.0.0
 * @created 2025-01-30
 */

import { Counter, Histogram, Registry } from 'prom-client';

// åˆ›å»ºæŒ‡æ ‡æ³¨å†Œè¡¨
const register = new Registry();

// HTTP è¯·æ±‚æ€»æ•°
export const httpRequestsTotal = new Counter({
  name: 'http_requests_total',
  help: 'Total number of HTTP requests',
  labelNames: ['method', 'path', 'status_code'],
  registers: [register],
});

// HTTP è¯·æ±‚æŒç»­æ—¶é—´
export const httpRequestDuration = new Histogram({
  name: 'http_request_duration_seconds',
  help: 'HTTP request duration in seconds',
  labelNames: ['method', 'path', 'status_code'],
  buckets: [0.005, 0.01, 0.025, 0.05, 0.1, 0.25, 0.5, 1, 2.5, 5, 10],
  registers: [register],
});

// HTTP è¯·æ±‚å¤§å°
export const httpRequestSize = new Histogram({
  name: 'http_request_size_bytes',
  help: 'HTTP request size in bytes',
  labelNames: ['method', 'path'],
  buckets: [100, 1000, 10000, 100000, 1000000],
  registers: [register],
});

// HTTP å“åº”å¤§å°
export const httpResponseSize = new Histogram({
  name: 'http_response_size_bytes',
  help: 'HTTP response size in bytes',
  labelNames: ['method', 'path', 'status_code'],
  buckets: [100, 1000, 10000, 100000, 1000000],
  registers: [register],
});

// å¯¼å‡ºæŒ‡æ ‡
export const metrics = register;
```

#### 2.2.2 æ•°æ®åº“æŒ‡æ ‡

```typescript
/**
 * @file æ•°æ®åº“æŒ‡æ ‡æ”¶é›†
 * @description æ”¶é›†æ•°æ®åº“æ“ä½œç›¸å…³æŒ‡æ ‡
 * @module metrics/database
 * @author YYCÂ³
 * @version 1.0.0
 * @created 2025-01-30
 */

import { Counter, Histogram, Gauge, Registry } from 'prom-client';

const register = new Registry();

// æ•°æ®åº“æŸ¥è¯¢æ€»æ•°
export const dbQueriesTotal = new Counter({
  name: 'db_queries_total',
  help: 'Total number of database queries',
  labelNames: ['operation', 'table', 'status'],
  registers: [register],
});

// æ•°æ®åº“æŸ¥è¯¢æŒç»­æ—¶é—´
export const dbQueryDuration = new Histogram({
  name: 'db_query_duration_seconds',
  help: 'Database query duration in seconds',
  labelNames: ['operation', 'table'],
  buckets: [0.001, 0.005, 0.01, 0.025, 0.05, 0.1, 0.25, 0.5, 1],
  registers: [register],
});

// æ•°æ®åº“è¿æ¥æ± å¤§å°
export const dbConnectionPoolSize = new Gauge({
  name: 'db_connection_pool_size',
  help: 'Database connection pool size',
  labelNames: ['state'],
  registers: [register],
});

// æ…¢æŸ¥è¯¢æ•°é‡
export const dbSlowQueries = new Counter({
  name: 'db_slow_queries_total',
  help: 'Total number of slow database queries',
  labelNames: ['table'],
  registers: [register],
});

export const metrics = register;
```

### 2.3 ä¸šåŠ¡æŒ‡æ ‡

#### 2.3.1 è®¢å•æŒ‡æ ‡

```typescript
/**
 * @file è®¢å•ä¸šåŠ¡æŒ‡æ ‡
 * @description æ”¶é›†è®¢å•ç›¸å…³ä¸šåŠ¡æŒ‡æ ‡
 * @module metrics/order
 * @author YYCÂ³
 * @version 1.0.0
 * @created 2025-01-30
 */

import { Counter, Histogram, Gauge, Registry } from 'prom-client';

const register = new Registry();

// è®¢å•åˆ›å»ºæ€»æ•°
export const ordersCreatedTotal = new Counter({
  name: 'orders_created_total',
  help: 'Total number of orders created',
  labelNames: ['restaurant_id', 'order_type'],
  registers: [register],
});

// è®¢å•æ”¯ä»˜æ€»æ•°
export const ordersPaidTotal = new Counter({
  name: 'orders_paid_total',
  help: 'Total number of orders paid',
  labelNames: ['payment_method', 'status'],
  registers: [register],
});

// è®¢å•é‡‘é¢
export const orderAmount = new Histogram({
  name: 'order_amount_cny',
  help: 'Order amount in CNY',
  labelNames: ['restaurant_id'],
  buckets: [10, 50, 100, 200, 500, 1000, 2000, 5000],
  registers: [register],
});

// è®¢å•å¤„ç†æ—¶é—´
export const orderProcessingDuration = new Histogram({
  name: 'order_processing_duration_seconds',
  help: 'Order processing duration in seconds',
  labelNames: ['restaurant_id', 'order_type'],
  buckets: [60, 120, 300, 600, 900, 1800, 3600],
  registers: [register],
});

// æ´»è·ƒè®¢å•æ•°
export const activeOrders = new Gauge({
  name: 'active_orders',
  help: 'Number of active orders',
  labelNames: ['status'],
  registers: [register],
});

export const metrics = register;
```

---

## 3. æ—¥å¿—ç›‘æ§

### 3.1 æ—¥å¿—æ”¶é›†

#### 3.1.1 Fluentd é…ç½®

```yaml
# === fluentd.conf ===
<source>
  @type tail
  path /var/log/containers/*.log
  pos_file /var/log/fluentd-containers.log.pos
  tag kubernetes.*
  read_from_head true
  <parse>
    @type json
    time_format %Y-%m-%dT%H:%M:%S.%NZ
  </parse>
</source>

<filter kubernetes.**>
  @type kubernetes_metadata
</filter>

<filter kubernetes.**>
  @type grep
  <regexp>
    key $.kubernetes.namespace_name
    pattern /^yyc3-(production|staging)$/
  </regexp>
</filter>

<match kubernetes.**>
  @type elasticsearch
  host elasticsearch.logging.svc.cluster.local
  port 9200
  logstash_format true
  logstash_prefix yyc3-${record['kubernetes']['namespace_name']}
  logstash_dateformat %Y.%m.%d
  include_tag_key true
  type_name _doc
  <buffer>
    @type file
    path /var/log/fluentd-buffers/kubernetes.system.buffer
    flush_mode interval
    flush_interval 5s
    chunk_limit_size 2M
    queue_limit_length 32
    retry_max_interval 30
    retry_forever true
  </buffer>
</match>
```

### 3.2 æ—¥å¿—ç»“æ„

#### 3.2.1 åº”ç”¨æ—¥å¿—æ ¼å¼

```typescript
/**
 * @file æ—¥å¿—æ ¼å¼åŒ–
 * @description ç»Ÿä¸€æ—¥å¿—æ ¼å¼
 * @module logger/formatter
 * @author YYCÂ³
 * @version 1.0.0
 * @created 2025-01-30
 */

export interface LogEntry {
  // æ—¶é—´æˆ³
  timestamp: string;
  
  // æ—¥å¿—çº§åˆ«
  level: 'debug' | 'info' | 'warn' | 'error' | 'fatal';
  
  // æ¶ˆæ¯
  message: string;
  
  // ä¸Šä¸‹æ–‡ä¿¡æ¯
  context?: {
    // æœåŠ¡åç§°
    service: string;
    // ç¯å¢ƒ
    environment: string;
    // ç‰ˆæœ¬
    version: string;
    // ä¸»æœºå
    hostname: string;
    // è¿›ç¨‹ ID
    pid: number;
  };
  
  // è¯·æ±‚ä¿¡æ¯
  request?: {
    // è¯·æ±‚ ID
    requestId: string;
    // ç”¨æˆ· ID
    userId?: string;
    // ä¼šè¯ ID
    sessionId?: string;
    // è¯·æ±‚æ–¹æ³•
    method?: string;
    // è¯·æ±‚è·¯å¾„
    path?: string;
    // å®¢æˆ·ç«¯ IP
    clientIp?: string;
    // User-Agent
    userAgent?: string;
  };
  
  // é”™è¯¯ä¿¡æ¯
  error?: {
    // é”™è¯¯åç§°
    name: string;
    // é”™è¯¯æ¶ˆæ¯
    message: string;
    // å †æ ˆè·Ÿè¸ª
    stack?: string;
    // é”™è¯¯ä»£ç 
    code?: string;
  };
  
  // è‡ªå®šä¹‰å­—æ®µ
  [key: string]: any;
}

/**
 * æ ¼å¼åŒ–æ—¥å¿—æ¡ç›®
 * @param entry æ—¥å¿—æ¡ç›®
 * @returns JSON å­—ç¬¦ä¸²
 */
export function formatLogEntry(entry: LogEntry): string {
  return JSON.stringify(entry);
}

/**
 * åˆ›å»ºæ—¥å¿—æ¡ç›®
 * @param level æ—¥å¿—çº§åˆ«
 * @param message æ¶ˆæ¯
 * @param context ä¸Šä¸‹æ–‡
 * @returns æ—¥å¿—æ¡ç›®
 */
export function createLogEntry(
  level: LogEntry['level'],
  message: string,
  context?: Partial<LogEntry>
): LogEntry {
  return {
    timestamp: new Date().toISOString(),
    level,
    message,
    context: {
      service: process.env.SERVICE_NAME || 'unknown',
      environment: process.env.NODE_ENV || 'development',
      version: process.env.APP_VERSION || '1.0.0',
      hostname: require('os').hostname(),
      pid: process.pid,
      ...context?.context,
    },
    ...context,
  };
}
```

---

## 4. é“¾è·¯è¿½è¸ª

### 4.1 OpenTelemetry é…ç½®

#### 4.1.1 åˆå§‹åŒ–é…ç½®

```typescript
/**
 * @file OpenTelemetry åˆå§‹åŒ–
 * @description åˆå§‹åŒ–é“¾è·¯è¿½è¸ª
 * @module tracing/otel
 * @author YYCÂ³
 * @version 1.0.0
 * @created 2025-01-30
 */

import { NodeSDK } from '@opentelemetry/sdk-node';
import { Resource } from '@opentelemetry/resources';
import { SemanticResourceAttributes } from '@opentelemetry/semantic-conventions';
import { HttpInstrumentation } from '@opentelemetry/instrumentation-http';
import { ExpressInstrumentation } from '@opentelemetry/instrumentation-express';
import { PgInstrumentation } from '@opentelemetry/instrumentation-pg';
import { IORedisInstrumentation } from '@opentelemetry/instrumentation-ioredis';
import { JaegerExporter } from '@opentelemetry/exporter-trace-jaeger';
import { BatchSpanProcessor } from '@opentelemetry/sdk-trace-base';

/**
 * åˆå§‹åŒ– OpenTelemetry SDK
 */
export function initializeTracing(): NodeSDK {
  const resource = Resource.default().merge(
    new Resource({
      [SemanticResourceAttributes.SERVICE_NAME]: process.env.SERVICE_NAME || 'yyc3-backend',
      [SemanticResourceAttributes.SERVICE_VERSION]: process.env.APP_VERSION || '1.0.0',
      [SemanticResourceAttributes.DEPLOYMENT_ENVIRONMENT]: process.env.NODE_ENV || 'development',
    })
  );

  // Jaeger å¯¼å‡ºå™¨
  const jaegerExporter = new JaegerExporter({
    endpoint: process.env.JAEGER_ENDPOINT || 'http://localhost:14268/api/traces',
  });

  const sdk = new NodeSDK({
    resource,
    traceExporter: jaegerExporter,
    spanProcessor: new BatchSpanProcessor(jaegerExporter),
    instrumentations: [
      new HttpInstrumentation(),
      new ExpressInstrumentation(),
      new PgInstrumentation(),
      new IORedisInstrumentation(),
    ],
  });

  sdk.start();
  console.log('OpenTelemetry tracing initialized');

  return sdk;
}
```

### 4.2 åˆ†å¸ƒå¼è¿½è¸ª

#### 4.2.1 ä¸­é—´ä»¶é›†æˆ

```typescript
/**
 * @file è¿½è¸ªä¸­é—´ä»¶
 * @description Express è¿½è¸ªä¸­é—´ä»¶
 * @module tracing/middleware
 * @author YYCÂ³
 * @version 1.0.0
 * @created 2025-01-30
 */

import { trace } from '@opentelemetry/api';
import { Request, Response, NextFunction } from 'express';

/**
 * è¿½è¸ªä¸­é—´ä»¶
 * @param req è¯·æ±‚
 * @param res å“åº”
 * @param next ä¸‹ä¸€ä¸ªä¸­é—´ä»¶
 */
export function tracingMiddleware(req: Request, res: Response, next: NextFunction): void {
  const tracer = trace.getTracer('yyc3-backend');

  const span = tracer.startSpan(`${req.method} ${req.path}`, {
    attributes: {
      'http.method': req.method,
      'http.url': req.url,
      'http.target': req.path,
      'http.host': req.get('host'),
      'http.user_agent': req.get('user-agent'),
      'http.client_ip': req.ip,
      'user.id': (req as any).userId,
    },
  });

  // å°† span ç»‘å®šåˆ°ä¸Šä¸‹æ–‡
  trace.setSpan(trace.active(), span);

  // è®°å½•å“åº”
  res.on('finish', () => {
    span.setAttributes({
      'http.status_code': res.statusCode,
      'http.response_size': res.get('content-length'),
    });

    if (res.statusCode >= 400) {
      span.setStatus({
        code: 2, // ERROR
        message: `HTTP ${res.statusCode}`,
      });
    } else {
      span.setStatus({ code: 1 }); // OK
    }

    span.end();
  });

  next();
}
```

---

## 5. å‘Šè­¦ç³»ç»Ÿ

### 5.1 å‘Šè­¦è§„åˆ™

#### 5.1.1 åº”ç”¨å‘Šè­¦

```yaml
# === alerts/application.yml ===
groups:
  - name: application_alerts
    interval: 30s
    rules:
      # é«˜é”™è¯¯ç‡å‘Šè­¦
      - alert: HighErrorRate
        expr: |
          rate(http_requests_total{status=~"5.."}[5m]) 
          / rate(http_requests_total[5m]) > 0.05
        for: 5m
        labels:
          severity: critical
          team: backend
        annotations:
          summary: "High error rate detected"
          description: "Error rate is {{ $value | humanizePercentage }} for {{ $labels.instance }}"

      # é«˜å»¶è¿Ÿå‘Šè­¦
      - alert: HighLatency
        expr: |
          histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m])) > 1
        for: 5m
        labels:
          severity: warning
          team: backend
        annotations:
          summary: "High latency detected"
          description: "95th percentile latency is {{ $value }}s for {{ $labels.instance }}"

      # æœåŠ¡ä¸å¯ç”¨å‘Šè­¦
      - alert: ServiceDown
        expr: up{job="yyc3-backend"} == 0
        for: 1m
        labels:
          severity: critical
          team: backend
        annotations:
          summary: "Service is down"
          description: "Service {{ $labels.instance }} is not responding"

      # æ•°æ®åº“è¿æ¥æ± è€—å°½
      - alert: DatabaseConnectionPoolExhausted
        expr: |
          db_connection_pool_size{state="idle"} == 0
        for: 5m
        labels:
          severity: critical
          team: database
        annotations:
          summary: "Database connection pool exhausted"
          description: "No idle connections available in the pool"
```

#### 5.1.2 åŸºç¡€è®¾æ–½å‘Šè­¦

```yaml
# === alerts/infrastructure.yml ===
groups:
  - name: infrastructure_alerts
    interval: 30s
    rules:
      # CPU ä½¿ç”¨ç‡è¿‡é«˜
      - alert: HighCPUUsage
        expr: |
          100 - (avg by(instance) (rate(node_cpu_seconds_total{mode="idle"}[5m])) * 100) > 80
        for: 10m
        labels:
          severity: warning
          team: ops
        annotations:
          summary: "High CPU usage"
          description: "CPU usage is {{ $value }}% on {{ $labels.instance }}"

      # å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜
      - alert: HighMemoryUsage
        expr: |
          (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100 > 85
        for: 10m
        labels:
          severity: warning
          team: ops
        annotations:
          summary: "High memory usage"
          description: "Memory usage is {{ $value }}% on {{ $labels.instance }}"

      # ç£ç›˜ç©ºé—´ä¸è¶³
      - alert: DiskSpaceLow
        expr: |
          (node_filesystem_avail_bytes / node_filesystem_size_bytes) * 100 < 10
        for: 5m
        labels:
          severity: critical
          team: ops
        annotations:
          summary: "Disk space low"
          description: "Disk space is {{ $value }}% available on {{ $labels.instance }}"

      # Pod é‡å¯é¢‘ç¹
      - alert: PodRestartingTooOften
        expr: |
          increase(kube_pod_container_status_restarts_total[1h]) > 5
        for: 10m
        labels:
          severity: warning
          team: ops
        annotations:
          summary: "Pod restarting too often"
          description: "Pod {{ $labels.pod }} has restarted {{ $value }} times in the last hour"
```

### 5.2 å‘Šè­¦é€šçŸ¥

#### 5.2.1 Alertmanager é…ç½®

```yaml
# === alertmanager.yml ===
global:
  resolve_timeout: 5m
  slack_api_url: '${SLACK_WEBHOOK_URL}'

route:
  receiver: 'default-receiver'
  group_wait: 10s
  group_interval: 10s
  repeat_interval: 12h
  group_by: ['alertname', 'cluster', 'service']

  routes:
    # Critical å‘Šè­¦ç«‹å³é€šçŸ¥
    - match:
        severity: critical
      receiver: 'critical-receiver'
      group_wait: 0s
      repeat_interval: 5m

    # Warning å‘Šè­¦å»¶è¿Ÿé€šçŸ¥
    - match:
        severity: warning
      receiver: 'warning-receiver'
      group_wait: 5m
      repeat_interval: 1h

receivers:
  - name: 'default-receiver'
    slack_configs:
      - channel: '#yyc3-alerts'
        send_resolved: true
        title: '{{ .Status | toUpper }}: {{ .CommonLabels.alertname }}'
        text: >-
          {{ range .Alerts }}
          *Alert:* {{ .Labels.alertname }}
          *Severity:* {{ .Labels.severity }}
          *Description:* {{ .Annotations.description }}
          *Details:*
          {{ range .Labels.SortedPairs }} â€¢ *{{ .Name }}:* {{ .Value }}
          {{ end }}
          {{ end }}

  - name: 'critical-receiver'
    slack_configs:
      - channel: '#yyc3-critical'
        send_resolved: true
        title: 'ğŸš¨ CRITICAL: {{ .CommonLabels.alertname }}'
        color: 'danger'
        text: >-
          {{ range .Alerts }}
          *Alert:* {{ .Labels.alertname }}
          *Severity:* {{ .Labels.severity }}
          *Description:* {{ .Annotations.description }}
          *Details:*
          {{ range .Labels.SortedPairs }} â€¢ *{{ .Name }}:* {{ .Value }}
          {{ end }}
          {{ end }}

  - name: 'warning-receiver'
    slack_configs:
      - channel: '#yyc3-warnings'
        send_resolved: true
        title: 'âš ï¸ WARNING: {{ .CommonLabels.alertname }}'
        color: 'warning'
        text: >-
          {{ range .Alerts }}
          *Alert:* {{ .Labels.alertname }}
          *Severity:* {{ .Labels.severity }}
          *Description:* {{ .Annotations.description }}
          {{ end }}
```

---

## 6. æ€§èƒ½ç›‘æ§

### 6.1 APM é›†æˆ

#### 6.1.1 æ€§èƒ½æŒ‡æ ‡æ”¶é›†

```typescript
/**
 * @file APM æ€§èƒ½ç›‘æ§
 * @description åº”ç”¨æ€§èƒ½ç›‘æ§
 * @module apm/performance
 * @author YYCÂ³
 * @version 1.0.0
 * @created 2025-01-30
 */

import { PerformanceObserver, performance } from 'perf_hooks';

/**
 * æ€§èƒ½ç›‘æ§ç±»
 */
export class PerformanceMonitor {
  private metrics: Map<string, number[]> = new Map();

  /**
   * è®°å½•æ€§èƒ½æŒ‡æ ‡
   * @param name æŒ‡æ ‡åç§°
   * @param duration æŒç»­æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
   */
  record(name: string, duration: number): void {
    if (!this.metrics.has(name)) {
      this.metrics.set(name, []);
    }
    this.metrics.get(name)!.push(duration);
  }

  /**
   * è·å–æŒ‡æ ‡ç»Ÿè®¡
   * @param name æŒ‡æ ‡åç§°
   * @returns ç»Ÿè®¡ä¿¡æ¯
   */
  getStats(name: string) {
    const values = this.metrics.get(name) || [];
    if (values.length === 0) {
      return null;
    }

    const sorted = [...values].sort((a, b) => a - b);
    const sum = values.reduce((acc, val) => acc + val, 0);

    return {
      count: values.length,
      min: sorted[0],
      max: sorted[sorted.length - 1],
      avg: sum / values.length,
      p50: sorted[Math.floor(sorted.length * 0.5)],
      p95: sorted[Math.floor(sorted.length * 0.95)],
      p99: sorted[Math.floor(sorted.length * 0.99)],
    };
  }

  /**
   * æµ‹é‡å‡½æ•°æ‰§è¡Œæ—¶é—´
   * @param name æŒ‡æ ‡åç§°
   * @param fn è¦æµ‹é‡çš„å‡½æ•°
   * @returns å‡½æ•°æ‰§è¡Œç»“æœ
   */
  async measure<T>(name: string, fn: () => Promise<T>): Promise<T> {
    const start = performance.now();
    try {
      const result = await fn();
      const duration = performance.now() - start;
      this.record(name, duration);
      return result;
    } catch (error) {
      const duration = performance.now() - start;
      this.record(`${name}.error`, duration);
      throw error;
    }
  }
}

// å…¨å±€æ€§èƒ½ç›‘æ§å®ä¾‹
export const performanceMonitor = new PerformanceMonitor();
```

### 6.2 å‰ç«¯æ€§èƒ½ç›‘æ§

#### 6.2.1 Web Vitals æ”¶é›†

```typescript
/**
 * @file Web Vitals ç›‘æ§
 * @description æ”¶é›† Web æ€§èƒ½æŒ‡æ ‡
 * @module apm/web-vitals
 * @author YYCÂ³
 * @version 1.0.0
 * @created 2025-01-30
 */

import { onCLS, onFID, onFCP, onLCP, onTTFB } from 'web-vitals';

/**
 * Web Vitals æŒ‡æ ‡æ¥å£
 */
interface WebVitalsMetric {
  name: string;
  value: number;
  rating: 'good' | 'needs-improvement' | 'poor';
  id: string;
  delta: number;
}

/**
 * å‘é€æŒ‡æ ‡åˆ°åç«¯
 * @param metric æŒ‡æ ‡
 */
function sendToAnalytics(metric: WebVitalsMetric): void {
  fetch('/api/analytics/web-vitals', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify(metric),
    keepalive: true,
  });
}

/**
 * åˆå§‹åŒ– Web Vitals ç›‘æ§
 */
export function initWebVitals(): void {
  // CLS (Cumulative Layout Shift)
  onCLS((metric) => {
    sendToAnalytics({
      name: 'CLS',
      value: metric.value,
      rating: metric.rating as any,
      id: metric.id,
      delta: metric.delta,
    });
  });

  // FID (First Input Delay)
  onFID((metric) => {
    sendToAnalytics({
      name: 'FID',
      value: metric.value,
      rating: metric.rating as any,
      id: metric.id,
      delta: metric.delta,
    });
  });

  // FCP (First Contentful Paint)
  onFCP((metric) => {
    sendToAnalytics({
      name: 'FCP',
      value: metric.value,
      rating: metric.rating as any,
      id: metric.id,
      delta: metric.delta,
    });
  });

  // LCP (Largest Contentful Paint)
  onLCP((metric) => {
    sendToAnalytics({
      name: 'LCP',
      value: metric.value,
      rating: metric.rating as any,
      id: metric.id,
      delta: metric.delta,
    });
  });

  // TTFB (Time to First Byte)
  onTTFB((metric) => {
    sendToAnalytics({
      name: 'TTFB',
      value: metric.value,
      rating: metric.rating as any,
      id: metric.id,
      delta: metric.delta,
    });
  });
}
```

---

## 7. ä¸šåŠ¡ç›‘æ§

### 7.1 ä¸šåŠ¡æŒ‡æ ‡

#### 7.1.1 æ ¸å¿ƒä¸šåŠ¡æŒ‡æ ‡

```typescript
/**
 * @file ä¸šåŠ¡æŒ‡æ ‡ç›‘æ§
 * @description ç›‘æ§æ ¸å¿ƒä¸šåŠ¡æŒ‡æ ‡
 * @module metrics/business
 * @author YYCÂ³
 * @version 1.0.0
 * @created 2025-01-30
 */

import { Counter, Histogram, Gauge, Registry } from 'prom-client';

const register = new Registry();

// ç”¨æˆ·æ³¨å†Œæ•°
export const userRegistrations = new Counter({
  name: 'user_registrations_total',
  help: 'Total number of user registrations',
  labelNames: ['channel'],
  registers: [register],
});

// æ´»è·ƒç”¨æˆ·æ•°
export const activeUsers = new Gauge({
  name: 'active_users',
  help: 'Number of active users',
  labelNames: ['period'], // daily, weekly, monthly
  registers: [register],
});

// è®¢å•è½¬åŒ–ç‡
export const orderConversionRate = new Gauge({
  name: 'order_conversion_rate',
  help: 'Order conversion rate',
  labelNames: ['funnel_step'], // view, add_to_cart, checkout, payment
  registers: [register],
});

// GMV (Gross Merchandise Value)
export const gmv = new Counter({
  name: 'gmv_total',
  help: 'Gross Merchandise Value',
  labelNames: ['restaurant_id', 'category'],
  registers: [register],
});

// å¹³å‡è®¢å•ä»·å€¼
export const averageOrderValue = new Histogram({
  name: 'average_order_value_cny',
  help: 'Average order value in CNY',
  labelNames: ['restaurant_id'],
  buckets: [10, 50, 100, 200, 500, 1000],
  registers: [register],
});

// ç”¨æˆ·ç•™å­˜ç‡
export const userRetentionRate = new Gauge({
  name: 'user_retention_rate',
  help: 'User retention rate',
  labelNames: ['period'], // day1, day7, day30
  registers: [register],
});

export const metrics = register;
```

---

## 8. ç›‘æ§æœ€ä½³å®è·µ

### 8.1 ç›‘æ§æ£€æŸ¥æ¸…å•

#### 8.1.1 ç›‘æ§è¦†ç›–æ£€æŸ¥

```markdown
## ç›‘æ§è¦†ç›–æ£€æŸ¥æ¸…å•

### åŸºç¡€è®¾æ–½ç›‘æ§
- [ ] CPU ä½¿ç”¨ç‡
- [ ] å†…å­˜ä½¿ç”¨ç‡
- [ ] ç£ç›˜ä½¿ç”¨ç‡
- [ ] ç½‘ç»œæµé‡
- [ ] å®¹å™¨èµ„æºä½¿ç”¨

### åº”ç”¨ç›‘æ§
- [ ] HTTP è¯·æ±‚æŒ‡æ ‡
- [ ] æ•°æ®åº“æŸ¥è¯¢æŒ‡æ ‡
- [ ] ç¼“å­˜å‘½ä¸­ç‡
- [ ] æ¶ˆæ¯é˜Ÿåˆ—æŒ‡æ ‡
- [ ] é”™è¯¯ç‡å’Œå»¶è¿Ÿ

### ä¸šåŠ¡ç›‘æ§
- [ ] ç”¨æˆ·æ³¨å†Œæ•°
- [ ] æ´»è·ƒç”¨æˆ·æ•°
- [ ] è®¢å•è½¬åŒ–ç‡
- [ ] GMV å’Œæ”¶å…¥
- [ ] ç”¨æˆ·ç•™å­˜ç‡

### å‘Šè­¦é…ç½®
- [ ] Critical å‘Šè­¦é…ç½®
- [ ] Warning å‘Šè­¦é…ç½®
- [ ] å‘Šè­¦é€šçŸ¥æ¸ é“
- [ ] å‘Šè­¦å‡çº§ç­–ç•¥
- [ ] å‘Šè­¦æŠ‘åˆ¶è§„åˆ™

### ä»ªè¡¨æ¿
- [ ] ç³»ç»Ÿæ¦‚è§ˆä»ªè¡¨æ¿
- [ ] åº”ç”¨æ€§èƒ½ä»ªè¡¨æ¿
- [ ] ä¸šåŠ¡æŒ‡æ ‡ä»ªè¡¨æ¿
- [ ] é”™è¯¯åˆ†æä»ªè¡¨æ¿
- [ ] å®¹é‡è§„åˆ’ä»ªè¡¨æ¿
```

---

## ğŸ“„ æ–‡æ¡£æ ‡å°¾ (Footer)

> ã€Œ***YanYuCloudCube***ã€
> ã€Œ***<admin@0379.email>***ã€
> ã€Œ***Words Initiate Quadrants, Language Serves as Core for the Future***ã€
> ã€Œ***All things converge in the cloud pivot; Deep stacks ignite a new era of intelligence***ã€




## æ¦‚è¿°

### æ¶æ„æ¦‚è¿°

æœ¬æ¶æ„æ–‡æ¡£è¯¦ç»†æè¿°äº†ç³»ç»Ÿçš„æ•´ä½“æ¶æ„è®¾è®¡ï¼ŒåŒ…æ‹¬æ¶æ„ç›®æ ‡ã€è®¾è®¡åŸåˆ™ã€æŠ€æœ¯é€‰å‹ç­‰å…³é”®ä¿¡æ¯ã€‚

#### æ¶æ„ç›®æ ‡

- **é«˜å¯ç”¨æ€§**ï¼šç¡®ä¿ç³»ç»Ÿç¨³å®šè¿è¡Œï¼Œæ•…éšœè‡ªåŠ¨æ¢å¤
- **é«˜æ€§èƒ½**ï¼šå“åº”è¿…é€Ÿï¼Œèµ„æºåˆ©ç”¨é«˜æ•ˆ
- **é«˜å®‰å…¨æ€§**ï¼šæ•°æ®åŠ å¯†ï¼Œæƒé™ä¸¥æ ¼æ§åˆ¶
- **é«˜æ‰©å±•æ€§**ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºåŠŸèƒ½æ‰©å±•
- **é«˜å¯ç»´æŠ¤æ€§**ï¼šä»£ç æ¸…æ™°ï¼Œæ–‡æ¡£å®Œå–„

#### è®¾è®¡åŸåˆ™

- **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªç»„ä»¶åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½
- **å¼€é—­åŸåˆ™**ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­
- **ä¾èµ–å€’ç½®**ï¼šä¾èµ–æŠ½è±¡è€Œéå…·ä½“å®ç°
- **æ¥å£éš”ç¦»**ï¼šä½¿ç”¨ç»†ç²’åº¦çš„æ¥å£
- **è¿ªç±³ç‰¹æ³•åˆ™**ï¼šæœ€å°‘çŸ¥è¯†åŸåˆ™



## æ¶æ„è®¾è®¡

### æ¶æ„è®¾è®¡

#### æ•´ä½“æ¶æ„

ç³»ç»Ÿé‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼ŒåŒ…æ‹¬ï¼š

- **è¡¨ç°å±‚**ï¼šè´Ÿè´£ç”¨æˆ·ç•Œé¢å’Œäº¤äº’
- **åº”ç”¨å±‚**ï¼šå¤„ç†ä¸šåŠ¡é€»è¾‘
- **ä¸šåŠ¡å±‚**ï¼šå®ç°æ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½
- **æ•°æ®å±‚**ï¼šç®¡ç†æ•°æ®å­˜å‚¨å’Œè®¿é—®
- **åŸºç¡€è®¾æ–½å±‚**ï¼šæä¾›åŸºç¡€æœåŠ¡æ”¯æŒ

#### æ¨¡å—åˆ’åˆ†

ç³»ç»Ÿåˆ’åˆ†ä¸ºå¤šä¸ªç‹¬ç«‹æ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—è´Ÿè´£ç‰¹å®šåŠŸèƒ½ï¼š

- **ç”¨æˆ·æ¨¡å—**ï¼šç”¨æˆ·ç®¡ç†å’Œè®¤è¯
- **è®¢å•æ¨¡å—**ï¼šè®¢å•å¤„ç†å’Œç®¡ç†
- **æ”¯ä»˜æ¨¡å—**ï¼šæ”¯ä»˜é›†æˆå’Œå¤„ç†
- **é€šçŸ¥æ¨¡å—**ï¼šæ¶ˆæ¯é€šçŸ¥å’Œæ¨é€
- **æŠ¥è¡¨æ¨¡å—**ï¼šæ•°æ®ç»Ÿè®¡å’Œåˆ†æ

#### æŠ€æœ¯é€‰å‹

- **å‰ç«¯æ¡†æ¶**ï¼šReact / Vue
- **åç«¯æ¡†æ¶**ï¼šNode.js / Express / Fastify
- **æ•°æ®åº“**ï¼šPostgreSQL / MongoDB
- **ç¼“å­˜**ï¼šRedis
- **æ¶ˆæ¯é˜Ÿåˆ—**ï¼šRabbitMQ / Kafka



## æŠ€æœ¯å®ç°

### æŠ€æœ¯å®ç°

#### æ ¸å¿ƒæŠ€æœ¯æ ˆ

```typescript
// æ ¸å¿ƒä¾èµ–
{
  "dependencies": {
    "react": "^18.0.0",
    "typescript": "^5.0.0",
    "express": "^4.18.0",
    "prisma": "^5.0.0",
    "redis": "^4.6.0"
  }
}
```

#### å…³é”®å®ç°

1. **æœåŠ¡å±‚å®ç°**
```typescript
class UserService {
  async createUser(data: CreateUserDto): Promise<User> {
    // éªŒè¯è¾“å…¥
    this.validateUserData(data);
    
    // åŠ å¯†å¯†ç 
    const hashedPassword = await this.hashPassword(data.password);
    
    // åˆ›å»ºç”¨æˆ·
    const user = await this.userRepository.create({
      ...data,
      password: hashedPassword
    });
    
    return user;
  }
}
```

2. **ä¸­é—´ä»¶å®ç°**
```typescript
const authMiddleware = async (req: Request, res: Response, next: NextFunction) => {
  const token = req.headers.authorization?.split(' ')[1];
  
  if (!token) {
    return res.status(401).json({ error: 'æœªæˆæƒè®¿é—®' });
  }
  
  try {
    const decoded = jwt.verify(token, process.env.JWT_SECRET);
    req.user = decoded;
    next();
  } catch (error) {
    return res.status(401).json({ error: 'ä»¤ç‰Œæ— æ•ˆ' });
  }
};
```



## éƒ¨ç½²æ–¹æ¡ˆ

### éƒ¨ç½²æ–¹æ¡ˆ

#### éƒ¨ç½²æ¶æ„

é‡‡ç”¨å®¹å™¨åŒ–éƒ¨ç½²æ–¹æ¡ˆï¼Œä½¿ç”¨Dockerå’ŒKubernetesè¿›è¡Œç¼–æ’ã€‚

#### éƒ¨ç½²æ­¥éª¤

1. **ç¯å¢ƒå‡†å¤‡**
```bash
# å®‰è£…Docker
curl -fsSL https://get.docker.com | sh

# å®‰è£…Kubernetes
# æ ¹æ®æ“ä½œç³»ç»Ÿé€‰æ‹©ç›¸åº”çš„å®‰è£…æ–¹å¼
```

2. **æ„å»ºé•œåƒ**
```bash
# æ„å»ºåº”ç”¨é•œåƒ
docker build -t yyc3-app:latest .

# æ¨é€åˆ°é•œåƒä»“åº“
docker push registry.example.com/yyc3-app:latest
```

3. **éƒ¨ç½²åˆ°Kubernetes**
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: yyc3-app
spec:
  replicas: 3
  selector:
    matchLabels:
      app: yyc3-app
  template:
    metadata:
      labels:
        app: yyc3-app
    spec:
      containers:
      - name: app
        image: registry.example.com/yyc3-app:latest
        ports:
        - containerPort: 3000
        env:
        - name: NODE_ENV
          value: "production"
```

4. **é…ç½®æœåŠ¡**
```yaml
apiVersion: v1
kind: Service
metadata:
  name: yyc3-app-service
spec:
  selector:
    app: yyc3-app
  ports:
  - protocol: TCP
    port: 80
    targetPort: 3000
  type: LoadBalancer
```



## æ€§èƒ½ä¼˜åŒ–

### æ€§èƒ½ä¼˜åŒ–

#### å‰ç«¯ä¼˜åŒ–

1. **ä»£ç åˆ†å‰²**
```typescript
// è·¯ç”±çº§åˆ«ä»£ç åˆ†å‰²
const Home = lazy(() => import('./pages/Home'));
const About = lazy(() => import('./pages/About'));

function App() {
  return (
    <Suspense fallback={<Loading />}>
      <Routes>
        <Route path="/" element={<Home />} />
        <Route path="/about" element={<About />} />
      </Routes>
    </Suspense>
  );
}
```

2. **ç¼“å­˜ç­–ç•¥**
```typescript
// React.memo é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“
const MemoizedComponent = React.memo(({ data }) => {
  return <div>{data.value}</div>;
});

// useMemo ç¼“å­˜è®¡ç®—ç»“æœ
const expensiveValue = useMemo(() => {
  return computeExpensiveValue(data);
}, [data]);
```

#### åç«¯ä¼˜åŒ–

1. **æ•°æ®åº“ä¼˜åŒ–**
```typescript
// ä½¿ç”¨ç´¢å¼•
CREATE INDEX idx_user_email ON users(email);

// æŸ¥è¯¢ä¼˜åŒ–
const users = await prisma.user.findMany({
  select: {
    id: true,
    name: true,
    email: true
  },
  where: {
    active: true
  },
  take: 100
});
```

2. **ç¼“å­˜ç­–ç•¥**
```typescript
// Redisç¼“å­˜
async function getUser(id: string): Promise<User> {
  const cacheKey = `user:${id}`;
  
  // å°è¯•ä»ç¼“å­˜è·å–
  const cached = await redis.get(cacheKey);
  if (cached) {
    return JSON.parse(cached);
  }
  
  // ä»æ•°æ®åº“è·å–
  const user = await prisma.user.findUnique({ where: { id } });
  
  // å†™å…¥ç¼“å­˜
  await redis.setex(cacheKey, 3600, JSON.stringify(user));
  
  return user;
}
```



## å®‰å…¨è€ƒè™‘

### å®‰å…¨è€ƒè™‘

#### è®¤è¯ä¸æˆæƒ

1. **JWTè®¤è¯**
```typescript
// ç”ŸæˆJWTä»¤ç‰Œ
const token = jwt.sign(
  { userId: user.id, role: user.role },
  process.env.JWT_SECRET,
  { expiresIn: '24h' }
);

// éªŒè¯JWTä»¤ç‰Œ
const decoded = jwt.verify(token, process.env.JWT_SECRET);
```

2. **RBACæˆæƒ**
```typescript
// è§’è‰²æƒé™æ£€æŸ¥
function checkPermission(user: User, resource: string, action: string): boolean {
  const permissions = rolePermissions[user.role];
  return permissions.some(p => 
    p.resource === resource && p.actions.includes(action)
  );
}
```

#### æ•°æ®ä¿æŠ¤

1. **è¾“å…¥éªŒè¯**
```typescript
// ä½¿ç”¨Zodè¿›è¡Œè¾“å…¥éªŒè¯
const createUserSchema = z.object({
  email: z.string().email(),
  password: z.string().min(8).regex(/[A-Z]/),
  name: z.string().min(2)
});

const validated = createUserSchema.parse(input);
```

2. **æ•°æ®åŠ å¯†**
```typescript
// ä½¿ç”¨bcryptåŠ å¯†å¯†ç 
const hashedPassword = await bcrypt.hash(password, 10);

// éªŒè¯å¯†ç 
const isValid = await bcrypt.compare(password, hashedPassword);
```

#### å®‰å…¨å¤´é…ç½®

```typescript
// Expresså®‰å…¨å¤´é…ç½®
app.use(helmet());
app.use(cors({
  origin: process.env.ALLOWED_ORIGINS?.split(','),
  credentials: true
}));
```



## ç›‘æ§å‘Šè­¦

### ç›‘æ§å‘Šè­¦

#### ç›‘æ§æŒ‡æ ‡

1. **ç³»ç»ŸæŒ‡æ ‡**
- CPUä½¿ç”¨ç‡
- å†…å­˜ä½¿ç”¨ç‡
- ç£ç›˜ä½¿ç”¨ç‡
- ç½‘ç»œI/O

2. **åº”ç”¨æŒ‡æ ‡**
- è¯·æ±‚é‡(RPS)
- å“åº”æ—¶é—´
- é”™è¯¯ç‡
- å¹¶å‘ç”¨æˆ·æ•°

3. **ä¸šåŠ¡æŒ‡æ ‡**
- ç”¨æˆ·æ³¨å†Œæ•°
- è®¢å•åˆ›å»ºæ•°
- æ”¯ä»˜æˆåŠŸç‡
- ç”¨æˆ·æ´»è·ƒåº¦

#### ç›‘æ§å·¥å…·

```typescript
// PrometheusæŒ‡æ ‡æ”¶é›†
import { Counter, Histogram, Gauge } from 'prom-client';

const requestCounter = new Counter({
  name: 'http_requests_total',
  help: 'Total number of HTTP requests',
  labelNames: ['method', 'route', 'status']
});

const responseTime = new Histogram({
  name: 'http_request_duration_seconds',
  help: 'HTTP request duration in seconds',
  labelNames: ['method', 'route']
});

// ä½¿ç”¨ä¸­é—´ä»¶è®°å½•æŒ‡æ ‡
app.use((req, res, next) => {
  const start = Date.now();
  
  res.on('finish', () => {
    const duration = (Date.now() - start) / 1000;
    requestCounter.inc({
      method: req.method,
      route: req.route?.path || req.path,
      status: res.statusCode
    });
    responseTime.observe({
      method: req.method,
      route: req.route?.path || req.path
    }, duration);
  });
  
  next();
});
```

#### å‘Šè­¦è§„åˆ™

```yaml
groups:
- name: api_alerts
  rules:
  - alert: HighErrorRate
    expr: rate(http_requests_total{status=~"5.."}[5m]) > 0.05
    for: 5m
    labels:
      severity: critical
    annotations:
      summary: "APIé”™è¯¯ç‡è¿‡é«˜"
      description: "5åˆ†é’Ÿå†…é”™è¯¯ç‡è¶…è¿‡5%"
  
  - alert: HighResponseTime
    expr: histogram_quantile(0.95, http_request_duration_seconds) > 1
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: "APIå“åº”æ—¶é—´è¿‡é•¿"
      description: "95%åˆ†ä½å“åº”æ—¶é—´è¶…è¿‡1ç§’"
```



## æœ€ä½³å®è·µ

### æœ€ä½³å®è·µ

#### ä»£ç è§„èŒƒ

1. **å‘½åè§„èŒƒ**
```typescript
// å˜é‡ï¼šcamelCase
const userName = 'John';

// å¸¸é‡ï¼šUPPER_SNAKE_CASE
const MAX_RETRY_COUNT = 3;

// ç±»ï¼šPascalCase
class UserService { }

// æ¥å£ï¼šPascalCaseï¼Œå‰ç¼€Iï¼ˆå¯é€‰ï¼‰
interface IUserService { }
```

2. **æ³¨é‡Šè§„èŒƒ**
```typescript
/**
 * åˆ›å»ºç”¨æˆ·
 * @param email - ç”¨æˆ·é‚®ç®±
 * @param password - ç”¨æˆ·å¯†ç 
 * @returns åˆ›å»ºçš„ç”¨æˆ·å¯¹è±¡
 * @throws {Error} å½“é‚®ç®±å·²å­˜åœ¨æ—¶æŠ›å‡ºé”™è¯¯
 */
async function createUser(
  email: string, 
  password: string
): Promise<User> {
  // å®ç°
}
```

#### é”™è¯¯å¤„ç†

```typescript
// ç»Ÿä¸€é”™è¯¯å¤„ç†
class AppError extends Error {
  constructor(
    public statusCode: number,
    public message: string,
    public isOperational = true
  ) {
    super(message);
    this.name = this.constructor.name;
    Error.captureStackTrace(this, this.constructor);
  }
}

// ä½¿ç”¨é”™è¯¯å¤„ç†ä¸­é—´ä»¶
app.use((err: Error, req: Request, res: Response, next: NextFunction) => {
  if (err instanceof AppError) {
    return res.status(err.statusCode).json({
      success: false,
      error: err.message
    });
  }
  
  // è®°å½•æœªé¢„æœŸçš„é”™è¯¯
  logger.error('Unexpected error:', err);
  
  return res.status(500).json({
    success: false,
    error: 'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯'
  });
});
```

#### æ—¥å¿—è®°å½•

```typescript
// ç»“æ„åŒ–æ—¥å¿—
import winston from 'winston';

const logger = winston.createLogger({
  level: 'info',
  format: winston.format.combine(
    winston.format.timestamp(),
    winston.format.json()
  ),
  transports: [
    new winston.transports.File({ filename: 'error.log', level: 'error' }),
    new winston.transports.File({ filename: 'combined.log' })
  ]
});

// ä½¿ç”¨æ—¥å¿—
logger.info('User created', { userId: user.id, email: user.email });
logger.error('Database connection failed', { error: error.message });
```


## ç›¸å…³æ–‡æ¡£

- [ğŸ”– YYCÂ³ æ™ºèƒ½æ¶æ„è®¾è®¡æ–‡æ¡£](YYC3-Cater-æ¶æ„è®¾è®¡/æ¶æ„ç±»/08-YYC3-Cater--æ¶æ„ç±»-æ™ºèƒ½æ¶æ„è®¾è®¡æ–‡æ¡£.md) - YYC3-Cater-æ¶æ„è®¾è®¡/æ¶æ„ç±»
- [YYC3 åˆç°ç³»ç»Ÿè‰²](YYC3-Cater-æ¶æ„è®¾è®¡/æ¶æ„ç±»/16-YYC3-Cater--æ¶æ„ç±»-ç³»ç»Ÿè‰²è®¾è®¡è§„èŒƒ.md) - YYC3-Cater-æ¶æ„è®¾è®¡/æ¶æ„ç±»
- [ğŸ”– YYCÂ³ éƒ¨ç½²æ¶æ„è®¾è®¡æ–‡æ¡£](YYC3-Cater-æ¶æ„è®¾è®¡/æ¶æ„ç±»/07-YYC3-Cater--æ¶æ„ç±»-éƒ¨ç½²æ¶æ„è®¾è®¡æ–‡æ¡£.md) - YYC3-Cater-æ¶æ„è®¾è®¡/æ¶æ„ç±»
- [ğŸ”– YYCÂ³ æ¥å£æ¶æ„è®¾è®¡æ–‡æ¡£](YYC3-Cater-æ¶æ„è®¾è®¡/æ¶æ„ç±»/06-YYC3-Cater--æ¶æ„ç±»-æ¥å£æ¶æ„è®¾è®¡æ–‡æ¡£.md) - YYC3-Cater-æ¶æ„è®¾è®¡/æ¶æ„ç±»
- [YYCÂ³é¤é¥®ç®¡ç†ç³»ç»Ÿ - å¯è®¿é—®æ€§è®¾è®¡è§„èŒƒ](YYC3-Cater-æ¶æ„è®¾è®¡/æ¶æ„ç±»/17-YYC3-Cater--æ¶æ„ç±»-å¯è®¿é—®æ€§æ ‡å‡†.md) - YYC3-Cater-æ¶æ„è®¾è®¡/æ¶æ„ç±»
