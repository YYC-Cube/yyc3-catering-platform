# 厨房显示功能模块需求分析与设计文档

## 1. 模块概述

### 1.1 模块简介

厨房显示功能模块是YYC³餐饮平台的核心显示系统，为厨房工作人员提供实时的订单信息、任务分配、进度跟踪等功能。该模块通过大屏幕展示，帮助厨房高效管理订单制作，提升出餐效率和客户满意度。

### 1.2 模块目标

- **实时显示**：实时展示订单信息，确保信息及时更新
- **清晰展示**：通过大屏幕清晰展示，便于厨房查看
- **任务分配**：自动或手动分配任务到工作站
- **进度跟踪**：实时跟踪订单制作进度
- **效率提升**：优化厨房工作流程，提升出餐效率
- **异常预警**：及时预警异常情况，避免延误

### 1.3 适用范围

- 厨房工作人员：查看订单、制作菜品、更新进度
- 厨房主管：监控厨房状态、分配任务、处理异常
- 服务员：查看订单进度、通知客户
- 餐厅管理者：监控厨房效率、分析数据

## 2. 功能需求

### 2.1 订单显示

#### 2.1.1 订单列表展示

**功能描述**：展示待处理订单列表。

**输入参数**：
- 筛选条件：订单状态、优先级、订单类型
- 排序方式：下单时间、优先级、预计完成时间
- 显示数量：每屏显示订单数

**输出结果**：
- 订单列表：符合条件的订单列表
- 订单数量：待处理订单数量
- 更新时间：最后更新时间

**业务规则**：
- 实时更新订单状态
- 新订单自动置顶
- 支持自动滚动
- 高亮超时订单

#### 2.1.2 订单详情展示

**功能描述**：展示订单详细信息。

**输入参数**：
- 订单ID：必填

**输出结果**：
- 订单信息：订单基本信息
- 客户信息：客户姓名、特殊要求
- 菜品信息：菜品列表、数量、备注
- 制作要求：制作要求、特殊备注
- 时间信息：下单时间、预计完成时间

**业务规则**：
- 支持展开/收起详情
- 特殊要求高亮显示
- 支持菜品图片显示

#### 2.1.3 订单状态显示

**功能描述**：展示订单制作状态。

**输入参数**：
- 订单ID：必填

**输出结果**：
- 订单状态：待处理、制作中、已完成、已出餐
- 菜品状态：各菜品的制作状态
- 进度百分比：订单完成进度

**业务规则**：
- 状态实时更新
- 进度条可视化
- 状态颜色区分

#### 2.1.4 订单优先级显示

**功能描述**：展示订单优先级。

**输入参数**：
- 订单ID：必填

**输出结果**：
- 优先级标签：高、中、低
- 优先级颜色：不同颜色区分

**业务规则**：
- VIP订单高优先级
- 超时订单自动提升优先级
- 优先级可手动调整

#### 2.1.5 订单计时显示

**功能描述**：显示订单等待时间。

**输入参数**：
- 订单ID：必填

**输出结果**：
- 等待时间：已等待时长
- 超时预警：是否超时
- 预计完成时间：预计完成时间

**业务规则**：
- 实时更新计时
- 超时订单红色预警
- 支持倒计时显示

### 2.2 工位显示

#### 2.2.1 工位列表展示

**功能描述**：展示厨房工作站列表。

**输入参数**：
- 工位类型：热菜、凉菜、面点、饮料等
- 工位状态：空闲、忙碌、故障

**输出结果**：
- 工位列表：所有工作站列表
- 工位状态：各工作站状态
- 工位任务：当前处理任务

**业务规则**：
- 工位状态实时更新
- 故障工位灰色显示
- 支持工位排序

#### 2.2.2 工位任务分配

**功能描述**：显示工位分配的任务。

**输入参数**：
- 工位ID：必填

**输出结果**：
- 任务列表：分配给该工位的任务
- 任务状态：任务完成状态
- 任务进度：任务完成进度

**业务规则**：
- 自动分配任务到合适工位
- 支持手动调整分配
- 任务按优先级排序

#### 2.2.3 工位效率显示

**功能描述**：显示工位工作效率。

**输入参数**：
- 工位ID：必填
- 时间范围：可选

**输出结果**：
- 效率指标：完成率、平均时间
- 效率排名：与其他工位对比
- 效率趋势：效率变化趋势

**业务规则**：
- 实时计算效率
- 低效工位预警
- 支持效率对比

#### 2.2.4 工位负载显示

**功能描述**：显示工位负载情况。

**输入参数**：
- 工位ID：必填

**输出结果**：
- 任务数量：当前任务数
- 负载率：负载百分比
- 负载状态：空闲、正常、过载

**业务规则**：
- 负载实时更新
- 过载工位红色预警
- 支持负载均衡

### 2.3 任务管理

#### 2.3.1 任务开始

**功能描述**：开始制作任务。

**输入参数**：
- 任务ID：必填
- 操作人员：可选

**输出结果**：
- 开始时间：任务开始时间
- 操作状态：成功或失败

**业务规则**：
- 开始后状态变更为制作中
- 记录开始时间和操作人
- 支持批量开始

#### 2.3.2 任务完成

**功能描述**：完成任务制作。

**输入参数**：
- 任务ID：必填
- 完成数量：实际完成数量
- 操作人员：可选

**输出结果**：
- 完成时间：任务完成时间
- 操作状态：成功或失败

**业务规则**：
- 完成后状态变更为已完成
- 记录完成时间和操作人
- 支持部分完成

#### 2.3.3 任务暂停

**功能描述**：暂停任务制作。

**输入参数**：
- 任务ID：必填
- 暂停原因：必填

**输出结果**：
- 暂停时间：任务暂停时间
- 操作状态：成功或失败

**业务规则**：
- 暂停后状态变更为暂停
- 记录暂停时间和原因
- 支持恢复任务

#### 2.3.4 任务取消

**功能描述**：取消任务制作。

**输入参数**：
- 任务ID：必填
- 取消原因：必填

**输出结果**：
- 取消时间：任务取消时间
- 操作状态：成功或失败

**业务规则**：
- 取消后状态变更为已取消
- 记录取消时间和原因
- 需要权限验证

#### 2.3.5 任务重新分配

**功能描述**：重新分配任务。

**输入参数**：
- 任务ID：必填
- 新工位：必填
- 重新分配原因：可选

**输出结果**：
- 重新分配时间：重新分配时间
- 操作状态：成功或失败

**业务规则**：
- 重新分配后更新任务状态
- 记录重新分配历史
- 支持批量重新分配

### 2.4 进度跟踪

#### 2.4.1 制作进度显示

**功能描述**：显示订单制作进度。

**输入参数**：
- 订单ID：必填

**输出结果**：
- 总进度：订单整体进度
- 菜品进度：各菜品制作进度
- 预计剩余时间：预计剩余时间

**业务规则**：
- 进度实时更新
- 进度条可视化
- 支持进度百分比显示

#### 2.4.2 菜品进度显示

**功能描述**：显示菜品制作进度。

**输入参数**：
- 订单ID：必填
- 菜品ID：必填

**输出结果**：
- 菜品状态：待制作、制作中、已完成
- 制作进度：制作进度百分比
- 当前工位：当前制作工位

**业务规则**：
- 菜品进度独立跟踪
- 支持菜品图片显示
- 进度颜色区分

#### 2.4.3 时间预估显示

**功能描述**：预估订单完成时间。

**输入参数**：
- 订单ID：必填

**输出结果**：
- 预计完成时间：预计完成时间
- 剩余时间：剩余时间
- 时间准确性：预估准确度

**业务规则**：
- 基于历史数据预估
- 实时调整预估时间
- 支持手动调整

### 2.5 语音播报

#### 2.5.1 新订单播报

**功能描述**：语音播报新订单。

**输入参数**：
- 订单信息：必填

**输出结果**：
- 播报状态：播报成功或失败
- 播报内容：播报文本

**业务规则**：
- 自动播报新订单
- 播报内容可配置
- 支持播报音量调节

#### 2.5.2 订单完成播报

**功能描述**：语音播报订单完成。

**输入参数**：
- 订单信息：必填

**输出结果**：
- 播报状态：播报成功或失败
- 播报内容：播报文本

**业务规则**：
- 自动播报订单完成
- 支持播报内容自定义
- 播报间隔可配置

#### 2.5.3 异常播报

**功能描述**：语音播报异常情况。

**输入参数**：
- 异常信息：必填

**输出结果**：
- 播报状态：播报成功或失败
- 播报内容：播报文本

**业务规则**：
- 自动播报异常情况
- 异常类型可区分
- 支持播报频率调节

### 2.6 视图切换

#### 2.6.1 订单视图

**功能描述**：切换到订单视图。

**输入参数**：
- 无

**输出结果**：
- 视图切换：切换到订单视图
- 视图内容：订单列表展示

**业务规则**：
- 视图状态保存
- 支持默认视图设置
- 切换动画流畅

#### 2.6.2 工位视图

**功能描述**：切换到工位视图。

**输入参数**：
- 无

**输出结果**：
- 视图切换：切换到工位视图
- 视图内容：工位列表展示

**业务规则**：
- 视图状态保存
- 支持工位排序
- 工位状态可视化

#### 2.6.3 汇总视图

**功能描述**：切换到汇总视图。

**输入参数**：
- 无

**输出结果**：
- 视图切换：切换到汇总视图
- 视图内容：汇总数据展示

**业务规则**：
- 汇总数据实时更新
- 支持多维度汇总
- 汇总图表可视化

### 2.7 设置管理

#### 2.7.1 显示设置

**功能描述**：配置显示参数。

**输入参数**：
- 字体大小：小、中、大
- 显示密度：紧凑、标准、宽松
- 刷新频率：手动、自动
- 自动滚动：开启、关闭

**输出结果**：
- 设置保存：设置保存状态
- 设置生效：设置立即生效

**业务规则**：
- 设置可保存
- 支持默认设置恢复
- 设置影响全局显示

#### 2.7.2 语音设置

**功能描述**：配置语音播报参数。

**输入参数**：
- 播报开关：开启、关闭
- 播报内容：播报内容配置
- 播报音量：音量大小
- 播报频率：播报间隔

**输出结果**：
- 设置保存：设置保存状态
- 播报测试：播报测试结果

**业务规则**：
- 支持播报测试
- 播报内容可自定义
- 音量可调节

#### 2.7.3 筛选设置

**功能描述**：配置显示筛选条件。

**输入参数**：
- 显示订单类型：堂食、外卖、自提
- 显示优先级：高、中、低
- 显示工位类型：热菜、凉菜等

**输出结果**：
- 设置保存：设置保存状态
- 筛选结果：筛选后的显示

**业务规则**：
- 筛选条件可组合
- 支持筛选方案保存
- 筛选实时生效

### 2.8 异常处理

#### 2.8.1 超时预警

**功能描述**：预警订单超时。

**输入参数**：
- 超时阈值：必填，单位为分钟
- 预警方式：弹窗、语音、闪烁

**输出结果**：
- 超时订单：超时订单列表
- 预警状态：预警触发状态

**业务规则**：
- 超时订单高亮显示
- 预警方式可组合
- 支持阈值调整

#### 2.8.2 缺料预警

**功能描述**：预警物料不足。

**输入参数**：
- 缺料阈值：必填
- 预警方式：弹窗、语音

**输出结果**：
- 缺料信息：缺料物料列表
- 预警状态：预警触发状态

**业务规则**：
- 缺料订单暂停制作
- 支持缺料标记
- 预警及时通知

#### 2.8.3 设备故障预警

**功能描述**：预警设备故障。

**输入参数**：
- 故障类型：必填
- 预警方式：弹窗、语音

**输出结果**：
- 故障信息：设备故障详情
- 预警状态：预警触发状态

**业务规则**：
- 故障工位禁用
- 支持故障标记
- 预警及时通知

## 3. 非功能需求

### 3.1 性能需求

- **响应时间**：订单更新延迟不超过2秒
- **刷新频率**：支持1-60秒刷新频率
- **并发处理**：支持至少50个并发用户
- **实时性**：数据延迟不超过3秒

### 3.2 可用性需求

- **易用性**：界面简洁直观，大字体显示
- **可访问性**：支持语音播报
- **多语言**：支持中英文切换
- **响应式设计**：支持不同分辨率大屏

### 3.3 安全需求

- **数据加密**：敏感数据加密传输
- **访问控制**：基于角色的访问控制
- **操作审计**：记录所有操作日志
- **数据备份**：定期备份显示数据

### 3.4 兼容性需求

- **浏览器兼容**：支持Chrome、Firefox、Safari、Edge最新版本
- **设备兼容**：支持Windows、macOS、Linux
- **分辨率**：支持1920x1080及以上分辨率
- **大屏支持**：支持各种尺寸大屏显示

## 4. 接口设计

### 4.1 订单显示接口

```typescript
// 获取待处理订单
GET /api/v1/kitchen-display/orders
Query Parameters:
  - status: string (pending, in_progress, ready)
  - priority: string (high, medium, low)
  - station: string
  - limit: number

Response:
{
  "success": true,
  "data": {
    "orders": [
      {
        "id": "1",
        "orderNumber": "ORD20250120001",
        "customerName": "张三",
        "priority": "high",
        "status": "pending",
        "orderTime": "2025-01-20T10:00:00Z",
        "estimatedTime": "2025-01-20T10:20:00Z",
        "items": [
          {
            "id": "1",
            "name": "宫保鸡丁",
            "quantity": 1,
            "status": "pending",
            "specialRequests": "少辣"
          }
        ],
        "station": "热菜",
        "assignedTo": "张厨师"
      }
    ],
    "pendingCount": 10,
    "inProgressCount": 5,
    "readyCount": 3
  }
}

// 更新订单状态
PATCH /api/v1/kitchen-display/orders/:id/status
Body:
{
  "status": "in_progress",
  "operatorId": "1"
}

Response:
{
  "success": true,
  "data": {
    "id": "1",
    "status": "in_progress",
    "updatedAt": "2025-01-20T10:05:00Z"
  }
}
```

### 4.2 工位管理接口

```typescript
// 获取工位列表
GET /api/v1/kitchen-display/stations

Response:
{
  "success": true,
  "data": {
    "stations": [
      {
        "id": "1",
        "name": "热菜",
        "type": "hot_dish",
        "status": "busy",
        "currentTask": {
          "orderId": "1",
          "orderNumber": "ORD20250120001",
          "progress": 50
        },
        "efficiency": {
          "completionRate": 95,
          "avgTime": 15,
          "rank": 1
        },
        "load": {
          "taskCount": 3,
          "loadRate": 75,
          "status": "normal"
        }
      }
    ]
  }
}

// 重新分配任务
POST /api/v1/kitchen-display/tasks/:id/reassign
Body:
{
  "newStationId": "2",
  "reason": "工位负载过高"
}

Response:
{
  "success": true,
  "data": {
    "taskId": "1",
    "oldStationId": "1",
    "newStationId": "2",
    "reassignedAt": "2025-01-20T10:10:00Z"
  }
}
```

### 4.3 进度跟踪接口

```typescript
// 更新菜品进度
PATCH /api/v1/kitchen-display/orders/:orderId/items/:itemId/progress
Body:
{
  "progress": 50,
  "operatorId": "1"
}

Response:
{
  "success": true,
  "data": {
    "itemId": "1",
    "progress": 50,
    "updatedAt": "2025-01-20T10:05:00Z"
  }
}

// 获取订单进度
GET /api/v1/kitchen-display/orders/:id/progress

Response:
{
  "success": true,
  "data": {
    "orderId": "1",
    "totalProgress": 60,
    "items": [
      {
        "itemId": "1",
        "name": "宫保鸡丁",
        "progress": 80,
        "status": "in_progress",
        "currentStation": "热菜"
      }
    ],
    "estimatedRemainingTime": 8
  }
}
```

### 4.4 语音播报接口

```typescript
// 播报新订单
POST /api/v1/kitchen-display/announce/new-order
Body:
{
  "orderId": "1",
  "orderNumber": "ORD20250120001",
  "content": "新订单，订单号ORD20250120001"
}

Response:
{
  "success": true,
  "data": {
    "announceId": "1",
    "announcedAt": "2025-01-20T10:00:00Z"
  }
}

// 播报订单完成
POST /api/v1/kitchen-display/announce/order-complete
Body:
{
  "orderId": "1",
  "content": "订单ORD20250120001已完成"
}

Response:
{
  "success": true,
  "data": {
    "announceId": "2",
    "announcedAt": "2025-01-20T10:20:00Z"
  }
}
```

## 5. 数据模型

### 5.1 订单显示模型

```typescript
interface KitchenOrderDisplay {
  id: string;
  orderNumber: string;
  customerName: string;
  priority: OrderPriority;
  status: OrderStatus;
  orderTime: string;
  estimatedTime: string;
  actualTime?: string;
  waitingTime: number;
  items: KitchenOrderItemDisplay[];
  station: string;
  stationId: string;
  assignedTo?: string;
  assignedToId?: string;
  specialRequests?: string;
  progress: number;
  isOverdue: boolean;
  tags: string[];
}

interface KitchenOrderItemDisplay {
  id: string;
  orderId: string;
  name: string;
  nameEn?: string;
  quantity: number;
  status: ItemStatus;
  progress: number;
  currentStation?: string;
  specialRequests?: string;
  imageUrl?: string;
  preparationTime?: number;
}

enum OrderPriority {
  HIGH = 'high',
  MEDIUM = 'medium',
  LOW = 'low'
}

enum OrderStatus {
  PENDING = 'pending',
  IN_PROGRESS = 'in_progress',
  READY = 'ready',
  COMPLETED = 'completed',
  CANCELLED = 'cancelled'
}

enum ItemStatus {
  PENDING = 'pending',
  IN_PROGRESS = 'in_progress',
  READY = 'ready',
  COMPLETED = 'completed'
}
```

### 5.2 工位模型

```typescript
interface KitchenStation {
  id: string;
  name: string;
  nameEn?: string;
  type: StationType;
  status: StationStatus;
  location?: string;
  capacity?: number;
  currentTask?: CurrentTask;
  efficiency?: StationEfficiency;
  load?: StationLoad;
  createdAt: string;
  updatedAt: string;
}

enum StationType {
  HOT_DISH = 'hot_dish',
  COLD_DISH = 'cold_dish',
  NOODLE = 'noodle',
  DRINK = 'drink',
  DESSERT = 'dessert'
}

enum StationStatus {
  IDLE = 'idle',
  BUSY = 'busy',
  MAINTENANCE = 'maintenance',
  OFFLINE = 'offline'
}

interface CurrentTask {
  orderId: string;
  orderNumber: string;
  progress: number;
  startTime: string;
  estimatedEndTime: string;
}

interface StationEfficiency {
  completionRate: number;
  avgPrepTime: number;
  rank: number;
  trend: number;
}

interface StationLoad {
  taskCount: number;
  loadRate: number;
  status: LoadStatus;
}

enum LoadStatus {
  LOW = 'low',
  NORMAL = 'normal',
  HIGH = 'high',
  OVERLOAD = 'overload'
}
```

### 5.3 语音播报模型

```typescript
interface VoiceAnnouncement {
  id: string;
  type: AnnouncementType;
  content: string;
  orderId?: string;
  orderNumber?: string;
  announcedAt: string;
  operatorId?: string;
  status: AnnouncementStatus;
}

enum AnnouncementType {
  NEW_ORDER = 'new_order',
  ORDER_COMPLETE = 'order_complete',
  ALERT = 'alert',
  CUSTOM = 'custom'
}

enum AnnouncementStatus {
  PENDING = 'pending',
  ANNOUNCED = 'announced',
  FAILED = 'failed'
}
```

## 6. 用户界面设计

### 6.1 订单视图

```
┌─────────────────────────────────────────────────────────────┐
│  厨房显示                                              │
├─────────────────────────────────────────────────────────────┤
│  [订单视图] [工位视图] [汇总视图]  [刷新]           │
│  当前时间: 2025-01-20 10:30:00                    │
│  待处理: 10  进行中: 5  已完成: 3                    │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐    │
│  │ 订单 #001   │ │ 订单 #002   │ │ 订单 #003   │    │
│  │ [高优先级]  │ │ [中优先级]  │ │ [低优先级]  │    │
│  │ 等待: 5分钟 │ │ 等待: 3分钟 │ │ 等待: 2分钟 │    │
│  │ ─────────────│ │ ─────────────│ │ ─────────────│    │
│  │ 客户: 张三  │ │ 客户: 李四  │ │ 客户: 王五  │    │
│  │ ─────────────│ │ ─────────────│ │ ─────────────│    │
│  │ 宫保鸡丁 ×1  │ │ 麻婆豆腐 ×1  │ │ 糖醋里脊 ×1  │    │
│  │ [制作中 50%]│ │ [待制作]    │ │ [待制作]    │    │
│  │ ─────────────│ │ ─────────────│ │ ─────────────│    │
│  │ [开始制作]   │ │ [开始制作]   │ │ [开始制作]   │    │
│  └─────────────┘ └─────────────┘ └─────────────┘    │
└─────────────────────────────────────────────────────────────┘
```

### 6.2 工位视图

```
┌─────────────────────────────────────────────────────────────┐
│  厨房显示 - 工位视图                                  │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐    │
│  │ 热菜工位    │ │ 凉菜工位    │ │ 面点工位    │    │
│  │ ─────────────│ │ ─────────────│ │ ─────────────│    │
│  │ 状态: 忙碌  │ │ 状态: 空闲  │ │ 状态: 忙碌  │    │
│  │ [██████████]│ │ [░░░░░░░░░]│ │ [██████░░░░]│    │
│  │ ─────────────│ │ ─────────────│ │ ─────────────│    │
│  │ 当前任务:    │ │ 当前任务:    │ │ 当前任务:    │    │
│  │ 订单 #001   │ │ 无          │ │ 订单 #003   │    │
│  │ 进度: 50%   │ │             │ │ 进度: 80%   │    │
│  │ ─────────────│ │ ─────────────│ │ ─────────────│    │
│  │ 效率: 95%   │ │ 效率: 92%   │ │ 效率: 88%   │    │
│  │ 排名: 1     │ │ 排名: 2     │ │ 排名: 3     │    │
│  │ ─────────────│ │ ─────────────│ │ ─────────────│    │
│  │ 负载: 正常  │ │ 负载: 低    │ │ 负载: 高    │    │
│  │ [███████░░░]│ │ [██░░░░░░░░]│ │ [██████████]│    │
│  └─────────────┘ └─────────────┘ └─────────────┘    │
└─────────────────────────────────────────────────────────────┘
```

## 7. 测试需求

### 7.1 单元测试

- 订单显示测试
- 工位管理测试
- 任务操作测试
- 进度跟踪测试
- 语音播报测试

### 7.2 集成测试

- 订单与工位集成测试
- 任务与进度集成测试
- 语音播报集成测试
- 异常预警集成测试

### 7.3 性能测试

- 实时更新性能测试
- 大数据量显示测试
- 并发访问测试
- 语音播报性能测试

### 7.4 用户验收测试

- 功能完整性测试
- 易用性测试
- 大屏显示测试
- 语音播报测试

## 8. 部署和维护

### 8.1 部署要求

- 显示设备：支持大屏显示（1920x1080及以上）
- 音频设备：支持语音播报
- 网络环境：稳定的网络连接
- 浏览器：支持现代浏览器

### 8.2 监控要求

- 系统监控：CPU、内存、网络
- 显示监控：显示状态、更新频率
- 业务监控：订单准确性、出餐及时性
- 异常监控：超时、缺料、故障

### 8.3 备份策略

- 配置备份：每次配置变更后备份
- 日志备份：每日备份，保留7天
- 数据同步：与后台系统实时同步

### 8.4 维护计划

- 定期更新：每月更新显示逻辑
- 性能优化：每季度进行性能优化
- 安全检查：每周进行安全检查
- 功能迭代：根据用户反馈持续优化

## 9. 版本历史

| 版本 | 日期 | 作者 | 变更说明 |
|------|------|------|---------|
| 1.0.0 | 2025-01-20 | YYC³ | 初始版本 |
