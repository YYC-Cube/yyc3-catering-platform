---

**@file**ï¼šYYCÂ³-å¤šç¯å¢ƒéƒ¨ç½²æ¶æ„å·®å¼‚æ–‡æ¡£
**@description**ï¼šYYCÂ³é¤é¥®è¡Œä¸šæ™ºèƒ½åŒ–å¹³å°çš„å¤šç¯å¢ƒéƒ¨ç½²æ¶æ„å·®å¼‚æ–‡æ¡£
**@author**ï¼šYYCÂ³
**@version**ï¼šv1.0.0
**@created**ï¼š2025-01-30
**@updated**ï¼š2025-01-30
**@status**ï¼špublished
**@tags**ï¼šæ¶æ„è®¾è®¡,éƒ¨ç½²,YYCÂ³,å®¹å™¨åŒ–

---
# ğŸ”– YYCÂ³ å¤šç¯å¢ƒéƒ¨ç½²æ¶æ„å·®å¼‚æ–‡æ¡£

> ***YanYuCloudCube***
> **æ ‡è¯­**ï¼šè¨€å¯è±¡é™ | è¯­æ¢æœªæ¥
> ***Words Initiate Quadrants, Language Serves as Core for the Future***
> **æ ‡è¯­**ï¼šä¸‡è±¡å½’å…ƒäºäº‘æ¢ | æ·±æ ˆæ™ºå¯æ–°çºªå…ƒ
> ***All things converge in the cloud pivot; Deep stacks ignite a new era of intelligence***

---

## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯

| å±æ€§ | å†…å®¹ |
|------|------|
| **æ–‡æ¡£æ ‡é¢˜** | YYCÂ³ å¤šç¯å¢ƒéƒ¨ç½²æ¶æ„å·®å¼‚æ–‡æ¡£ |
| **æ–‡æ¡£ç±»å‹** | æ¶æ„ç±»æ–‡æ¡£ |
| **æ‰€å±é˜¶æ®µ** | éƒ¨ç½²å‘å¸ƒ |
| **éµå¾ªè§„èŒƒ** | YYCÂ³ å›¢é˜Ÿæ ‡å‡†åŒ–è§„èŒƒ v1.0.0 |
| **ç‰ˆæœ¬å·** | v1.0.0 |
| **åˆ›å»ºæ—¥æœŸ** | 2025-01-30 |
| **ä½œè€…** | YYCÂ³ Team |
| **æ›´æ–°æ—¥æœŸ** | 2025-01-30 |

---

## ğŸ“‘ ç›®å½•

1. [ç¯å¢ƒæ¶æ„æ¦‚è¿°](#1-ç¯å¢ƒæ¶æ„æ¦‚è¿°)
2. [å¼€å‘ç¯å¢ƒ](#2-å¼€å‘ç¯å¢ƒ)
3. [æµ‹è¯•ç¯å¢ƒ](#3-æµ‹è¯•ç¯å¢ƒ)
4. [é¢„å‘å¸ƒç¯å¢ƒ](#4-é¢„å‘å¸ƒç¯å¢ƒ)
5. [ç”Ÿäº§ç¯å¢ƒ](#5-ç”Ÿäº§ç¯å¢ƒ)
6. [ç¯å¢ƒå·®å¼‚å¯¹æ¯”](#6-ç¯å¢ƒå·®å¼‚å¯¹æ¯”)
7. [ç¯å¢ƒåˆ‡æ¢ç­–ç•¥](#7-ç¯å¢ƒåˆ‡æ¢ç­–ç•¥)
8. [æ•°æ®è¿ç§»](#8-æ•°æ®è¿ç§»)
9. [ç¯å¢ƒéš”ç¦»](#9-ç¯å¢ƒéš”ç¦»)
10. [æœ€ä½³å®è·µ](#10-æœ€ä½³å®è·µ)

---

## 1. æ¦‚è¿°

### 1.1 è¯´æ˜

æœ¬æ–‡æ¡£æ˜¯YYCÂ³é¤é¥®è¡Œä¸šæ™ºèƒ½åŒ–å¹³å°æ–‡æ¡£ä½“ç³»çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œæ—¨åœ¨æä¾›æ¸…æ™°ã€å®Œæ•´ã€å‡†ç¡®çš„ä¿¡æ¯ã€‚

é€šè¿‡æœ¬æ–‡æ¡£ï¼Œè¯»è€…å¯ä»¥ï¼š
- äº†è§£ç›¸å…³æ¦‚å¿µå’ŒèƒŒæ™¯
- æŒæ¡æ ¸å¿ƒå†…å®¹å’Œè¦ç‚¹
- è·å¾—å®ç”¨çš„æŒ‡å¯¼å’Œå¸®åŠ©
- å‚è€ƒç›¸å…³çš„èµ„æºå’Œèµ„æ–™

æ–‡æ¡£éµå¾ªYYCÂ³å›¢é˜Ÿæ ‡å‡†åŒ–è§„èŒƒï¼Œç¡®ä¿å†…å®¹è´¨é‡å’Œä¸€è‡´æ€§ã€‚

### 1.2 ç›®æ ‡

æœ¬æ–‡æ¡£çš„ä¸»è¦ç›®æ ‡åŒ…æ‹¬ï¼š

- **ä¿¡æ¯ä¼ é€’**ï¼šå‡†ç¡®ä¼ é€’ç›¸å…³ä¿¡æ¯å’ŒçŸ¥è¯†
- **æŒ‡å¯¼å®è·µ**ï¼šæä¾›å®ç”¨çš„æŒ‡å¯¼å’Œå‚è€ƒ
- **é™ä½æˆæœ¬**ï¼šå‡å°‘æ²Ÿé€šæˆæœ¬å’Œå­¦ä¹ æˆæœ¬
- **æé«˜æ•ˆç‡**ï¼šå¸®åŠ©è¯»è€…å¿«é€Ÿç†è§£å’Œåº”ç”¨

é€šè¿‡å®ç°è¿™äº›ç›®æ ‡ï¼Œæ–‡æ¡£èƒ½å¤Ÿä¸ºé¡¹ç›®çš„æˆåŠŸåšå‡ºé‡è¦è´¡çŒ®ã€‚

### 1.3 èŒƒå›´

æœ¬æ–‡æ¡£çš„é€‚ç”¨èŒƒå›´ï¼š

- **é€‚ç”¨å¯¹è±¡**ï¼šå¼€å‘äººå‘˜ã€æµ‹è¯•äººå‘˜ã€è¿ç»´äººå‘˜ã€äº§å“ç»ç†ç­‰
- **é€‚ç”¨é˜¶æ®µ**ï¼šå¼€å‘ã€æµ‹è¯•ã€éƒ¨ç½²ã€è¿ç»´ç­‰å„ä¸ªé˜¶æ®µ
- **é€‚ç”¨åœºæ™¯**ï¼šæ—¥å¸¸å¼€å‘ã€é—®é¢˜æ’æŸ¥ã€ç³»ç»Ÿç»´æŠ¤ç­‰

è¶…å‡ºæœ¬æ–‡æ¡£èŒƒå›´çš„å†…å®¹ï¼Œè¯·å‚è€ƒå…¶ä»–ç›¸å…³æ–‡æ¡£ã€‚

## 2. è¯¦ç»†å†…å®¹

### 2.1 æ ¸å¿ƒå†…å®¹

### 2.2 å®ç°ç»†èŠ‚

### 2.3 æ³¨æ„äº‹é¡¹

## 3. å‚è€ƒä¿¡æ¯

### 3.1 ç›¸å…³æ–‡æ¡£

### 3.2 å‚è€ƒèµ„æ–™

### 3.3 é™„å½•

## 1. ç¯å¢ƒæ¶æ„æ¦‚è¿°

### 1.1 ç¯å¢ƒå±‚æ¬¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ç”Ÿäº§ç¯å¢ƒ (Production)            â”‚
â”‚      - ç”Ÿäº§æ•°æ®                          â”‚
â”‚      - é«˜å¯ç”¨æ¶æ„                        â”‚
â”‚      - å®Œæ•´ç›‘æ§å‘Šè­¦                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ æ•°æ®åŒæ­¥
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       é¢„å‘å¸ƒç¯å¢ƒ (Staging)               â”‚
â”‚      - ç”Ÿäº§æ•°æ®é•œåƒ                      â”‚
â”‚      - å®Œæ•´åŠŸèƒ½æµ‹è¯•                       â”‚
â”‚      - æ€§èƒ½æµ‹è¯•                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ éƒ¨ç½²éªŒè¯
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        æµ‹è¯•ç¯å¢ƒ (Testing)                â”‚
â”‚      - æµ‹è¯•æ•°æ®                          â”‚
â”‚      - é›†æˆæµ‹è¯•                          â”‚
â”‚      - å›å½’æµ‹è¯•                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ åŠŸèƒ½éªŒè¯
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       å¼€å‘ç¯å¢ƒ (Development)              â”‚
â”‚      - æœ¬åœ°å¼€å‘                          â”‚
â”‚      - å¿«é€Ÿè¿­ä»£                          â”‚
â”‚      - è°ƒè¯•å·¥å…·                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 ç¯å¢ƒå‘½åè§„èŒƒ

```typescript
// config/environments.ts
export enum Environment {
  DEVELOPMENT = 'development',
  TESTING = 'testing',
  STAGING = 'staging',
  PRODUCTION = 'production',
}

export const environmentConfig = {
  [Environment.DEVELOPMENT]: {
    name: 'å¼€å‘ç¯å¢ƒ',
    domain: 'dev.yyc3-cater.com',
    port: 3200,
    database: 'yyc3_cater_dev',
    redis: { host: 'localhost', port: 6379 },
  },
  [Environment.TESTING]: {
    name: 'æµ‹è¯•ç¯å¢ƒ',
    domain: 'test.yyc3-cater.com',
    port: 3201,
    database: 'yyc3_cater_test',
    redis: { host: 'redis-test', port: 6379 },
  },
  [Environment.STAGING]: {
    name: 'é¢„å‘å¸ƒç¯å¢ƒ',
    domain: 'staging.yyc3-cater.com',
    port: 3202,
    database: 'yyc3_cater_staging',
    redis: { host: 'redis-staging', port: 6379 },
  },
  [Environment.PRODUCTION]: {
    name: 'ç”Ÿäº§ç¯å¢ƒ',
    domain: 'www.yyc3-cater.com',
    port: 3203,
    database: 'yyc3_cater_prod',
    redis: { host: 'redis-prod', port: 6379 },
  },
};
```

---

## 2. å¼€å‘ç¯å¢ƒ

### 2.1 ç¯å¢ƒé…ç½®

```yaml
# docker-compose.dev.yml
version: '3.8'

services:
  web:
    build:
      context: .
      dockerfile: Dockerfile.dev
    ports:
      - "3200:3200"
    environment:
      - NODE_ENV=development
      - NEXT_PUBLIC_API_URL=http://localhost:3201
      - DATABASE_URL=postgresql://postgres:password@postgres:5432/yyc3_cater_dev
      - REDIS_URL=redis://redis:6379
    volumes:
      - .:/app
      - /app/node_modules
    depends_on:
      - postgres
      - redis

  api:
    build:
      context: ./api
      dockerfile: Dockerfile.dev
    ports:
      - "3201:3201"
    environment:
      - NODE_ENV=development
      - DATABASE_URL=postgresql://postgres:password@postgres:5432/yyc3_cater_dev
      - REDIS_URL=redis://redis:6379
    volumes:
      - ./api:/app
      - /app/node_modules
    depends_on:
      - postgres
      - redis

  postgres:
    image: postgres:15-alpine
    ports:
      - "5432:5432"
    environment:
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=password
      - POSTGRES_DB=yyc3_cater_dev
    volumes:
      - postgres-dev-data:/var/lib/postgresql/data

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis-dev-data:/data

volumes:
  postgres-dev-data:
  redis-dev-data:
```

### 2.2 å¼€å‘å·¥å…·

```json
{
  "scripts": {
    "dev": "next dev -p 3200",
    "dev:api": "cd api && pnpm dev -p 3201",
    "dev:all": "concurrently \"pnpm dev\" \"pnpm dev:api\"",
    "lint": "eslint . --ext .ts,.tsx",
    "format": "prettier --write .",
    "type-check": "tsc --noEmit"
  },
  "devDependencies": {
    "@types/node": "^20.0.0",
    "@types/react": "^18.0.0",
    "typescript": "^5.0.0",
    "eslint": "^8.0.0",
    "prettier": "^3.0.0",
    "concurrently": "^8.0.0"
  }
}
```

---

## 3. æµ‹è¯•ç¯å¢ƒ

### 3.1 ç¯å¢ƒé…ç½®

```yaml
# k8s/testing/deployment.yml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: yyc3-cater-web
  namespace: testing
spec:
  replicas: 2
  selector:
    matchLabels:
      app: yyc3-cater
      component: web
  template:
    metadata:
      labels:
        app: yyc3-cater
        component: web
    spec:
      containers:
      - name: web
        image: ghcr.io/yyc3-cater/web:latest
        ports:
        - containerPort: 3200
        env:
        - name: NODE_ENV
          value: "testing"
        - name: NEXT_PUBLIC_API_URL
          value: "https://api-test.yyc3-cater.com"
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: yyc3-cater-secrets
              key: database-url
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: yyc3-cater-secrets
              key: redis-url
        resources:
          requests:
            memory: "256Mi"
            cpu: "250m"
          limits:
            memory: "512Mi"
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /health
            port: 3200
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /ready
            port: 3200
          initialDelaySeconds: 5
          periodSeconds: 5
```

### 3.2 æµ‹è¯•æ•°æ®

```sql
-- æµ‹è¯•æ•°æ®åˆå§‹åŒ–è„šæœ¬
-- init-test-data.sql

-- æ¸…ç†æµ‹è¯•æ•°æ®
TRUNCATE TABLE users, merchants, products, orders, payments, inventory, customers, marketing_campaigns CASCADE;

-- æ’å…¥æµ‹è¯•ç”¨æˆ·
INSERT INTO users (id, email, name, role, created_at) VALUES
  ('user-001', 'test-user-1@example.com', 'æµ‹è¯•ç”¨æˆ·1', 'merchant', NOW()),
  ('user-002', 'test-user-2@example.com', 'æµ‹è¯•ç”¨æˆ·2', 'merchant', NOW()),
  ('user-003', 'test-user-3@example.com', 'æµ‹è¯•ç”¨æˆ·3', 'customer', NOW());

-- æ’å…¥æµ‹è¯•å•†æˆ·
INSERT INTO merchants (id, user_id, name, description, status, created_at) VALUES
  ('merchant-001', 'user-001', 'æµ‹è¯•å•†æˆ·1', 'æµ‹è¯•å•†æˆ·æè¿°1', 'active', NOW()),
  ('merchant-002', 'user-002', 'æµ‹è¯•å•†æˆ·2', 'æµ‹è¯•å•†æˆ·æè¿°2', 'active', NOW());

-- æ’å…¥æµ‹è¯•å•†å“
INSERT INTO products (id, merchant_id, name, description, price, stock, status, created_at) VALUES
  ('product-001', 'merchant-001', 'æµ‹è¯•å•†å“1', 'æµ‹è¯•å•†å“æè¿°1', 99.99, 100, 'available', NOW()),
  ('product-002', 'merchant-001', 'æµ‹è¯•å•†å“2', 'æµ‹è¯•å•†å“æè¿°2', 199.99, 50, 'available', NOW()),
  ('product-003', 'merchant-002', 'æµ‹è¯•å•†å“3', 'æµ‹è¯•å•†å“æè¿°3', 149.99, 75, 'available', NOW());
```

---

## 4. é¢„å‘å¸ƒç¯å¢ƒ

### 4.1 ç¯å¢ƒé…ç½®

```yaml
# k8s/staging/deployment.yml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: yyc3-cater-web
  namespace: staging
spec:
  replicas: 3
  selector:
    matchLabels:
      app: yyc3-cater
      component: web
  template:
    metadata:
      labels:
        app: yyc3-cater
        component: web
    spec:
      containers:
      - name: web
        image: ghcr.io/yyc3-cater/web:staging
        ports:
        - containerPort: 3200
        env:
        - name: NODE_ENV
          value: "staging"
        - name: NEXT_PUBLIC_API_URL
          value: "https://api-staging.yyc3-cater.com"
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: yyc3-cater-secrets
              key: database-url
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: yyc3-cater-secrets
              key: redis-url
        resources:
          requests:
            memory: "512Mi"
            cpu: "500m"
          limits:
            memory: "1Gi"
            cpu: "1000m"
        livenessProbe:
          httpGet:
            path: /health
            port: 3200
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /ready
            port: 3200
          initialDelaySeconds: 5
          periodSeconds: 5
```

### 4.2 æ•°æ®åŒæ­¥

```bash
#!/bin/bash
# æ•°æ®åŒæ­¥è„šæœ¬: production -> staging

set -euo pipefail

# é…ç½®
PROD_DB_HOST="postgres-prod.production.svc.cluster.local"
STAGING_DB_HOST="postgres-staging.staging.svc.cluster.local"
DB_NAME="yyc3_cater_prod"
DB_USER="postgres"

# åŒæ­¥æ•°æ®
echo "å¼€å§‹åŒæ­¥ç”Ÿäº§æ•°æ®åˆ°é¢„å‘å¸ƒç¯å¢ƒ..."

# 1. å¤‡ä»½ç”Ÿäº§æ•°æ®
echo "å¤‡ä»½ç”Ÿäº§æ•°æ®..."
pg_dump -h $PROD_DB_HOST -U $DB_USER -d $DB_NAME > /tmp/prod-backup.sql

# 2. è„±æ•å¤„ç†
echo "è„±æ•å¤„ç†..."
sed -i 's/[0-9]\{11\}/13800138000/g' /tmp/prod-backup.sql  # æ‰‹æœºå·è„±æ•
sed -i 's/[^@]*@/***@/g' /tmp/prod-backup.sql  # é‚®ç®±è„±æ•

# 3. å¯¼å…¥åˆ°é¢„å‘å¸ƒç¯å¢ƒ
echo "å¯¼å…¥æ•°æ®åˆ°é¢„å‘å¸ƒç¯å¢ƒ..."
psql -h $STAGING_DB_HOST -U $DB_USER -d $DB_NAME < /tmp/prod-backup.sql

# 4. æ¸…ç†
rm /tmp/prod-backup.sql

echo "æ•°æ®åŒæ­¥å®Œæˆ"
```

---

## 5. ç”Ÿäº§ç¯å¢ƒ

### 5.1 ç¯å¢ƒé…ç½®

```yaml
# k8s/production/deployment.yml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: yyc3-cater-web
  namespace: production
spec:
  replicas: 5
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0
  selector:
    matchLabels:
      app: yyc3-cater
      component: web
  template:
    metadata:
      labels:
        app: yyc3-cater
        component: web
    spec:
      affinity:
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - weight: 100
            podAffinityTerm:
              labelSelector:
                matchExpressions:
                - key: app
                  operator: In
                  values:
                  - yyc3-cater
              topologyKey: kubernetes.io/hostname
      containers:
      - name: web
        image: ghcr.io/yyc3-cater/web:latest
        ports:
        - containerPort: 3200
        env:
        - name: NODE_ENV
          value: "production"
        - name: NEXT_PUBLIC_API_URL
          value: "https://api.yyc3-cater.com"
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: yyc3-cater-secrets
              key: database-url
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: yyc3-cater-secrets
              key: redis-url
        resources:
          requests:
            memory: "1Gi"
            cpu: "1000m"
          limits:
            memory: "2Gi"
            cpu: "2000m"
        livenessProbe:
          httpGet:
            path: /health
            port: 3200
          initialDelaySeconds: 30
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /ready
            port: 3200
          initialDelaySeconds: 5
          periodSeconds: 5
          timeoutSeconds: 3
          failureThreshold: 3
```

### 5.2 é«˜å¯ç”¨é…ç½®

```yaml
# k8s/production/hpa.yml
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: yyc3-cater-web-hpa
  namespace: production
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: yyc3-cater-web
  minReplicas: 5
  maxReplicas: 20
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 70
  - type: Resource
    resource:
      name: memory
      target:
        type: Utilization
        averageUtilization: 80
  behavior:
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
      - type: Percent
        value: 50
        periodSeconds: 60
    scaleUp:
      stabilizationWindowSeconds: 0
      policies:
      - type: Percent
        value: 100
        periodSeconds: 60
```

---

## 6. ç¯å¢ƒå·®å¼‚å¯¹æ¯”

### 6.1 é…ç½®å·®å¼‚

| é…ç½®é¡¹ | å¼€å‘ç¯å¢ƒ | æµ‹è¯•ç¯å¢ƒ | é¢„å‘å¸ƒç¯å¢ƒ | ç”Ÿäº§ç¯å¢ƒ |
|--------|---------|---------|-----------|---------|
| Node.js ç‰ˆæœ¬ | 18.x | 18.x | 18.x | 18.x |
| å‰¯æœ¬æ•° | 1 | 2 | 3 | 5+ |
| CPU é™åˆ¶ | 500m | 500m | 1000m | 2000m |
| å†…å­˜é™åˆ¶ | 512Mi | 512Mi | 1Gi | 2Gi |
| æ•°æ®åº“ | æœ¬åœ° | æµ‹è¯•åº“ | é¢„å‘å¸ƒåº“ | ç”Ÿäº§åº“ |
| Redis | æœ¬åœ° | æµ‹è¯•Redis | é¢„å‘å¸ƒRedis | ç”Ÿäº§Redis |
| æ—¥å¿—çº§åˆ« | debug | info | warn | error |
| ç›‘æ§ | åŸºç¡€ | åŸºç¡€ | å®Œæ•´ | å®Œæ•´ |
| å¤‡ä»½ | æ—  | æ¯æ—¥ | æ¯æ—¥ | å®æ—¶ |

### 6.2 åŠŸèƒ½å·®å¼‚

| åŠŸèƒ½ | å¼€å‘ç¯å¢ƒ | æµ‹è¯•ç¯å¢ƒ | é¢„å‘å¸ƒç¯å¢ƒ | ç”Ÿäº§ç¯å¢ƒ |
|------|---------|---------|-----------|---------|
| çƒ­é‡è½½ | âœ… | âŒ | âŒ | âŒ |
| è°ƒè¯•å·¥å…· | âœ… | âŒ | âŒ | âŒ |
| æ¨¡æ‹Ÿæ•°æ® | âœ… | âœ… | âŒ | âŒ |
| çœŸå®æ•°æ® | âŒ | âŒ | âœ… | âœ… |
| æ€§èƒ½æµ‹è¯• | âŒ | âœ… | âœ… | âœ… |
| å®‰å…¨æ‰«æ | âŒ | âœ… | âœ… | âœ… |
| å‹åŠ›æµ‹è¯• | âŒ | âœ… | âœ… | âŒ |
| ç›‘æ§å‘Šè­¦ | âŒ | âœ… | âœ… | âœ… |

---

## 7. ç¯å¢ƒåˆ‡æ¢ç­–ç•¥

### 7.1 éƒ¨ç½²æµç¨‹

```typescript
// scripts/deploy.ts
import { execSync } from 'child_process';
import { Environment } from '../config/environments';

interface DeployOptions {
  environment: Environment;
  version: string;
  skipTests?: boolean;
  skipBackup?: boolean;
}

async function deploy(options: DeployOptions) {
  console.log(`å¼€å§‹éƒ¨ç½²åˆ° ${options.environment} ç¯å¢ƒ...`);

  // 1. è¿è¡Œæµ‹è¯•
  if (!options.skipTests) {
    console.log('è¿è¡Œæµ‹è¯•...');
    execSync('pnpm test', { stdio: 'inherit' });
  }

  // 2. æ„å»ºé•œåƒ
  console.log('æ„å»ºé•œåƒ...');
  execSync(`docker build -t ghcr.io/yyc3-cater/web:${options.version} .`, {
    stdio: 'inherit',
  });

  // 3. æ¨é€é•œåƒ
  console.log('æ¨é€é•œåƒ...');
  execSync(`docker push ghcr.io/yyc3-cater/web:${options.version}`, {
    stdio: 'inherit',
  });

  // 4. å¤‡ä»½ï¼ˆä»…ç”Ÿäº§ç¯å¢ƒï¼‰
  if (options.environment === Environment.PRODUCTION && !options.skipBackup) {
    console.log('å¤‡ä»½æ•°æ®...');
    execSync('./scripts/backup.sh', { stdio: 'inherit' });
  }

  // 5. æ›´æ–°éƒ¨ç½²
  console.log('æ›´æ–°éƒ¨ç½²...');
  const namespace = options.environment;
  execSync(
    `kubectl set image deployment/yyc3-cater-web web=ghcr.io/yyc3-cater/web:${options.version} -n ${namespace}`,
    { stdio: 'inherit' }
  );

  // 6. ç­‰å¾…éƒ¨ç½²å®Œæˆ
  console.log('ç­‰å¾…éƒ¨ç½²å®Œæˆ...');
  execSync(
    `kubectl rollout status deployment/yyc3-cater-web -n ${namespace} --timeout=10m`,
    { stdio: 'inherit' }
  );

  // 7. å¥åº·æ£€æŸ¥
  console.log('å¥åº·æ£€æŸ¥...');
  execSync(`./scripts/health-check.sh ${options.environment}`, { stdio: 'inherit' });

  console.log('éƒ¨ç½²å®Œæˆï¼');
}

// ä½¿ç”¨ç¤ºä¾‹
deploy({
  environment: Environment.STAGING,
  version: 'v1.0.0',
});
```

### 7.2 ç¯å¢ƒåˆ‡æ¢æ£€æŸ¥æ¸…å•

```markdown
## éƒ¨ç½²å‰æ£€æŸ¥æ¸…å•

### å¼€å‘ç¯å¢ƒ
- [ ] ä»£ç å·²æäº¤åˆ° develop åˆ†æ”¯
- [ ] å•å…ƒæµ‹è¯•é€šè¿‡
- [ ] æœ¬åœ°æ„å»ºæˆåŠŸ
- [ ] ä»£ç å®¡æŸ¥é€šè¿‡

### æµ‹è¯•ç¯å¢ƒ
- [ ] å¼€å‘ç¯å¢ƒéªŒè¯é€šè¿‡
- [ ] é›†æˆæµ‹è¯•é€šè¿‡
- [ ] æµ‹è¯•æ•°æ®å‡†å¤‡å®Œæˆ
- [ ] æµ‹è¯•ç¯å¢ƒé…ç½®æ­£ç¡®

### é¢„å‘å¸ƒç¯å¢ƒ
- [ ] æµ‹è¯•ç¯å¢ƒéªŒè¯é€šè¿‡
- [ ] E2E æµ‹è¯•é€šè¿‡
- [ ] æ€§èƒ½æµ‹è¯•é€šè¿‡
- [ ] æ•°æ®åŒæ­¥å®Œæˆ
- [ ] å®‰å…¨æ‰«æé€šè¿‡

### ç”Ÿäº§ç¯å¢ƒ
- [ ] é¢„å‘å¸ƒç¯å¢ƒéªŒè¯é€šè¿‡
- [ ] å›æ»šè®¡åˆ’å‡†å¤‡å®Œæˆ
- [ ] æ•°æ®å¤‡ä»½å®Œæˆ
- [ ] ç›‘æ§å‘Šè­¦é…ç½®æ­£ç¡®
- [ ] å›¢é˜Ÿé€šçŸ¥å®Œæˆ
```

---

## 8. æ•°æ®è¿ç§»

### 8.1 æ•°æ®è¿ç§»ç­–ç•¥

```typescript
// scripts/migrate.ts
import { Pool } from 'pg';

interface Migration {
  name: string;
  version: string;
  up: (pool: Pool) => Promise<void>;
  down: (pool: Pool) => Promise<void>;
}

const migrations: Migration[] = [
  {
    name: 'create-users-table',
    version: '001',
    up: async (pool) => {
      await pool.query(`
        CREATE TABLE IF NOT EXISTS users (
          id VARCHAR(255) PRIMARY KEY,
          email VARCHAR(255) UNIQUE NOT NULL,
          name VARCHAR(255) NOT NULL,
          password_hash VARCHAR(255) NOT NULL,
          role VARCHAR(50) DEFAULT 'customer',
          created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
          updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
        );
      `);
    },
    down: async (pool) => {
      await pool.query('DROP TABLE IF EXISTS users;');
    },
  },
  // æ›´å¤šè¿ç§»...
];

async function runMigrations(pool: Pool, direction: 'up' | 'down' = 'up') {
  console.log(`å¼€å§‹è¿è¡Œè¿ç§» (${direction})...`);

  for (const migration of migrations) {
    console.log(`æ‰§è¡Œè¿ç§»: ${migration.name} (${migration.version})`);

    try {
      if (direction === 'up') {
        await migration.up(pool);
      } else {
        await migration.down(pool);
      }

      // è®°å½•è¿ç§»çŠ¶æ€
      await pool.query(
        `INSERT INTO migrations (name, version, direction, executed_at) 
         VALUES ($1, $2, $3, NOW())`,
        [migration.name, migration.version, direction]
      );

      console.log(`è¿ç§» ${migration.name} å®Œæˆ`);
    } catch (error) {
      console.error(`è¿ç§» ${migration.name} å¤±è´¥:`, error);
      throw error;
    }
  }

  console.log('æ‰€æœ‰è¿ç§»å®Œæˆ');
}

// ä½¿ç”¨ç¤ºä¾‹
const pool = new Pool({
  connectionString: process.env.DATABASE_URL,
});

runMigrations(pool, 'up');
```

### 8.2 æ•°æ®è¿ç§»è„šæœ¬

```bash
#!/bin/bash
# æ•°æ®è¿ç§»è„šæœ¬

set -euo pipefail

ENVIRONMENT=${1:-staging}
MIGRATION_DIR="./migrations"

echo "å¼€å§‹è¿ç§»æ•°æ®åˆ° ${ENVIRONMENT} ç¯å¢ƒ..."

# 1. å¤‡ä»½å½“å‰æ•°æ®
echo "å¤‡ä»½æ•°æ®..."
./scripts/backup.sh $ENVIRONMENT

# 2. è¿è¡Œè¿ç§»
echo "è¿è¡Œè¿ç§»..."
pnpm ts-node scripts/migrate.ts up

# 3. éªŒè¯æ•°æ®
echo "éªŒè¯æ•°æ®..."
pnpm ts-node scripts/validate-data.ts

# 4. æ›´æ–°åº”ç”¨é…ç½®
echo "æ›´æ–°åº”ç”¨é…ç½®..."
kubectl set env deployment/yyc3-cater-web MIGRATION_VERSION=$(date +%Y%m%d%H%M%S) -n $ENVIRONMENT

echo "æ•°æ®è¿ç§»å®Œæˆ"
```

---

## 9. ç¯å¢ƒéš”ç¦»

### 9.1 ç½‘ç»œéš”ç¦»

```yaml
# k8s/network-policy.yml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: yyc3-cater-network-policy
  namespace: production
spec:
  podSelector:
    matchLabels:
      app: yyc3-cater
  policyTypes:
  - Ingress
  - Egress
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          name: ingress-nginx
    ports:
    - protocol: TCP
      port: 3200
  egress:
  - to:
    - namespaceSelector:
        matchLabels:
          name: production
    ports:
    - protocol: TCP
      port: 5432  # PostgreSQL
    - protocol: TCP
      port: 6379  # Redis
  - to:
    - namespaceSelector: {}
    ports:
    - protocol: TCP
      port: 443  # HTTPS
```

### 9.2 èµ„æºéš”ç¦»

```yaml
# k8s/resource-quota.yml
apiVersion: v1
kind: ResourceQuota
metadata:
  name: yyc3-cater-quota
  namespace: production
spec:
  hard:
    requests.cpu: "10"
    requests.memory: 20Gi
    limits.cpu: "20"
    limits.memory: 40Gi
    persistentvolumeclaims: "10"
    services: "10"
    secrets: "10"
```

---

## 10. æœ€ä½³å®è·µ

### 10.1 ç¯å¢ƒç®¡ç†åŸåˆ™

```typescript
// config/environment-principles.ts
export const environmentPrinciples = {
  // 1. ç¯å¢ƒä¸€è‡´æ€§
  consistency: {
    description: 'æ‰€æœ‰ç¯å¢ƒä½¿ç”¨ç›¸åŒçš„é…ç½®ç®¡ç†æ–¹å¼',
    implementation: 'ä½¿ç”¨ Helm Charts æˆ– Kustomize ç®¡ç†é…ç½®',
  },

  // 2. æœ€å°æƒé™
  leastPrivilege: {
    description: 'æ¯ä¸ªç¯å¢ƒåªæˆäºˆå¿…è¦çš„æƒé™',
    implementation: 'ä½¿ç”¨ RBAC å’Œ Service Account',
  },

  // 3. æ•°æ®éš”ç¦»
  dataIsolation: {
    description: 'ä¸åŒç¯å¢ƒä½¿ç”¨ç‹¬ç«‹çš„æ•°æ®åº“',
    implementation: 'ä½¿ç”¨ä¸åŒçš„æ•°æ®åº“å®ä¾‹å’Œå‘½åç©ºé—´',
  },

  // 4. å¯è¿½æº¯æ€§
  traceability: {
    description: 'æ‰€æœ‰å˜æ›´å¯è¿½æº¯',
    implementation: 'ä½¿ç”¨ Git æ ‡ç­¾å’Œç‰ˆæœ¬å·',
  },

  // 5. è‡ªåŠ¨åŒ–
  automation: {
    description: 'ç¯å¢ƒéƒ¨ç½²å’Œé…ç½®è‡ªåŠ¨åŒ–',
    implementation: 'ä½¿ç”¨ CI/CD æµæ°´çº¿',
  },
};
```

### 10.2 ç¯å¢ƒç›‘æ§

```typescript
// monitoring/environment-monitor.ts
import { promClient } from './prometheus';

const environmentMetrics = {
  // ç¯å¢ƒå¥åº·åº¦
  environmentHealth: new promClient.Gauge({
    name: 'yyc3_environment_health',
    help: 'Environment health status',
    labelNames: ['environment', 'component'],
  }),

  // éƒ¨ç½²æˆåŠŸç‡
  deploymentSuccessRate: new promClient.Gauge({
    name: 'yyc3_deployment_success_rate',
    help: 'Deployment success rate',
    labelNames: ['environment'],
  }),

  // ç¯å¢ƒå“åº”æ—¶é—´
  responseTime: new promClient.Histogram({
    name: 'yyc3_response_time',
    help: 'Response time',
    labelNames: ['environment', 'endpoint'],
    buckets: [0.1, 0.5, 1, 2, 5, 10],
  }),
};

// ç›‘æ§ç¯å¢ƒå¥åº·åº¦
async function monitorEnvironmentHealth(environment: string) {
  const health = await checkEnvironmentHealth(environment);
  environmentMetrics.environmentHealth.set(
    { environment, component: 'web' },
    health.web ? 1 : 0
  );
  environmentMetrics.environmentHealth.set(
    { environment, component: 'api' },
    health.api ? 1 : 0
  );
}

// æ£€æŸ¥ç¯å¢ƒå¥åº·åº¦
async function checkEnvironmentHealth(environment: string) {
  const webHealth = await checkServiceHealth(
    `https://${environment}.yyc3-cater.com/health`
  );
  const apiHealth = await checkServiceHealth(
    `https://api-${environment}.yyc3-cater.com/health`
  );

  return { web: webHealth, api: apiHealth };
}

// æ£€æŸ¥æœåŠ¡å¥åº·åº¦
async function checkServiceHealth(url: string): Promise<boolean> {
  try {
    const response = await fetch(url);
    return response.ok;
  } catch (error) {
    return false;
  }
}
```

---

## ğŸ“„ æ–‡æ¡£æ ‡å°¾ (Footer)

> ã€Œ***YanYuCloudCube***ã€
> ã€Œ***<admin@0379.email>***ã€
> ã€Œ***Words Initiate Quadrants, Language Serves as Core for Future***ã€
> ã€Œ***All things converge in cloud pivot; Deep stacks ignite a new era of intelligence***ã€




## æ¦‚è¿°

### æ¶æ„æ¦‚è¿°

æœ¬æ¶æ„æ–‡æ¡£è¯¦ç»†æè¿°äº†ç³»ç»Ÿçš„æ•´ä½“æ¶æ„è®¾è®¡ï¼ŒåŒ…æ‹¬æ¶æ„ç›®æ ‡ã€è®¾è®¡åŸåˆ™ã€æŠ€æœ¯é€‰å‹ç­‰å…³é”®ä¿¡æ¯ã€‚

#### æ¶æ„ç›®æ ‡

- **é«˜å¯ç”¨æ€§**ï¼šç¡®ä¿ç³»ç»Ÿç¨³å®šè¿è¡Œï¼Œæ•…éšœè‡ªåŠ¨æ¢å¤
- **é«˜æ€§èƒ½**ï¼šå“åº”è¿…é€Ÿï¼Œèµ„æºåˆ©ç”¨é«˜æ•ˆ
- **é«˜å®‰å…¨æ€§**ï¼šæ•°æ®åŠ å¯†ï¼Œæƒé™ä¸¥æ ¼æ§åˆ¶
- **é«˜æ‰©å±•æ€§**ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºåŠŸèƒ½æ‰©å±•
- **é«˜å¯ç»´æŠ¤æ€§**ï¼šä»£ç æ¸…æ™°ï¼Œæ–‡æ¡£å®Œå–„

#### è®¾è®¡åŸåˆ™

- **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªç»„ä»¶åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½
- **å¼€é—­åŸåˆ™**ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­
- **ä¾èµ–å€’ç½®**ï¼šä¾èµ–æŠ½è±¡è€Œéå…·ä½“å®ç°
- **æ¥å£éš”ç¦»**ï¼šä½¿ç”¨ç»†ç²’åº¦çš„æ¥å£
- **è¿ªç±³ç‰¹æ³•åˆ™**ï¼šæœ€å°‘çŸ¥è¯†åŸåˆ™



## æ¶æ„è®¾è®¡

### æ¶æ„è®¾è®¡

#### æ•´ä½“æ¶æ„

ç³»ç»Ÿé‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼ŒåŒ…æ‹¬ï¼š

- **è¡¨ç°å±‚**ï¼šè´Ÿè´£ç”¨æˆ·ç•Œé¢å’Œäº¤äº’
- **åº”ç”¨å±‚**ï¼šå¤„ç†ä¸šåŠ¡é€»è¾‘
- **ä¸šåŠ¡å±‚**ï¼šå®ç°æ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½
- **æ•°æ®å±‚**ï¼šç®¡ç†æ•°æ®å­˜å‚¨å’Œè®¿é—®
- **åŸºç¡€è®¾æ–½å±‚**ï¼šæä¾›åŸºç¡€æœåŠ¡æ”¯æŒ

#### æ¨¡å—åˆ’åˆ†

ç³»ç»Ÿåˆ’åˆ†ä¸ºå¤šä¸ªç‹¬ç«‹æ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—è´Ÿè´£ç‰¹å®šåŠŸèƒ½ï¼š

- **ç”¨æˆ·æ¨¡å—**ï¼šç”¨æˆ·ç®¡ç†å’Œè®¤è¯
- **è®¢å•æ¨¡å—**ï¼šè®¢å•å¤„ç†å’Œç®¡ç†
- **æ”¯ä»˜æ¨¡å—**ï¼šæ”¯ä»˜é›†æˆå’Œå¤„ç†
- **é€šçŸ¥æ¨¡å—**ï¼šæ¶ˆæ¯é€šçŸ¥å’Œæ¨é€
- **æŠ¥è¡¨æ¨¡å—**ï¼šæ•°æ®ç»Ÿè®¡å’Œåˆ†æ

#### æŠ€æœ¯é€‰å‹

- **å‰ç«¯æ¡†æ¶**ï¼šReact / Vue
- **åç«¯æ¡†æ¶**ï¼šNode.js / Express / Fastify
- **æ•°æ®åº“**ï¼šPostgreSQL / MongoDB
- **ç¼“å­˜**ï¼šRedis
- **æ¶ˆæ¯é˜Ÿåˆ—**ï¼šRabbitMQ / Kafka



## æŠ€æœ¯å®ç°

### æŠ€æœ¯å®ç°

#### æ ¸å¿ƒæŠ€æœ¯æ ˆ

```typescript
// æ ¸å¿ƒä¾èµ–
{
  "dependencies": {
    "react": "^18.0.0",
    "typescript": "^5.0.0",
    "express": "^4.18.0",
    "prisma": "^5.0.0",
    "redis": "^4.6.0"
  }
}
```

#### å…³é”®å®ç°

1. **æœåŠ¡å±‚å®ç°**
```typescript
class UserService {
  async createUser(data: CreateUserDto): Promise<User> {
    // éªŒè¯è¾“å…¥
    this.validateUserData(data);
    
    // åŠ å¯†å¯†ç 
    const hashedPassword = await this.hashPassword(data.password);
    
    // åˆ›å»ºç”¨æˆ·
    const user = await this.userRepository.create({
      ...data,
      password: hashedPassword
    });
    
    return user;
  }
}
```

2. **ä¸­é—´ä»¶å®ç°**
```typescript
const authMiddleware = async (req: Request, res: Response, next: NextFunction) => {
  const token = req.headers.authorization?.split(' ')[1];
  
  if (!token) {
    return res.status(401).json({ error: 'æœªæˆæƒè®¿é—®' });
  }
  
  try {
    const decoded = jwt.verify(token, process.env.JWT_SECRET);
    req.user = decoded;
    next();
  } catch (error) {
    return res.status(401).json({ error: 'ä»¤ç‰Œæ— æ•ˆ' });
  }
};
```



## éƒ¨ç½²æ–¹æ¡ˆ

### éƒ¨ç½²æ–¹æ¡ˆ

#### éƒ¨ç½²æ¶æ„

é‡‡ç”¨å®¹å™¨åŒ–éƒ¨ç½²æ–¹æ¡ˆï¼Œä½¿ç”¨Dockerå’ŒKubernetesè¿›è¡Œç¼–æ’ã€‚

#### éƒ¨ç½²æ­¥éª¤

1. **ç¯å¢ƒå‡†å¤‡**
```bash
# å®‰è£…Docker
curl -fsSL https://get.docker.com | sh

# å®‰è£…Kubernetes
# æ ¹æ®æ“ä½œç³»ç»Ÿé€‰æ‹©ç›¸åº”çš„å®‰è£…æ–¹å¼
```

2. **æ„å»ºé•œåƒ**
```bash
# æ„å»ºåº”ç”¨é•œåƒ
docker build -t yyc3-app:latest .

# æ¨é€åˆ°é•œåƒä»“åº“
docker push registry.example.com/yyc3-app:latest
```

3. **éƒ¨ç½²åˆ°Kubernetes**
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: yyc3-app
spec:
  replicas: 3
  selector:
    matchLabels:
      app: yyc3-app
  template:
    metadata:
      labels:
        app: yyc3-app
    spec:
      containers:
      - name: app
        image: registry.example.com/yyc3-app:latest
        ports:
        - containerPort: 3000
        env:
        - name: NODE_ENV
          value: "production"
```

4. **é…ç½®æœåŠ¡**
```yaml
apiVersion: v1
kind: Service
metadata:
  name: yyc3-app-service
spec:
  selector:
    app: yyc3-app
  ports:
  - protocol: TCP
    port: 80
    targetPort: 3000
  type: LoadBalancer
```



## æ€§èƒ½ä¼˜åŒ–

### æ€§èƒ½ä¼˜åŒ–

#### å‰ç«¯ä¼˜åŒ–

1. **ä»£ç åˆ†å‰²**
```typescript
// è·¯ç”±çº§åˆ«ä»£ç åˆ†å‰²
const Home = lazy(() => import('./pages/Home'));
const About = lazy(() => import('./pages/About'));

function App() {
  return (
    <Suspense fallback={<Loading />}>
      <Routes>
        <Route path="/" element={<Home />} />
        <Route path="/about" element={<About />} />
      </Routes>
    </Suspense>
  );
}
```

2. **ç¼“å­˜ç­–ç•¥**
```typescript
// React.memo é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“
const MemoizedComponent = React.memo(({ data }) => {
  return <div>{data.value}</div>;
});

// useMemo ç¼“å­˜è®¡ç®—ç»“æœ
const expensiveValue = useMemo(() => {
  return computeExpensiveValue(data);
}, [data]);
```

#### åç«¯ä¼˜åŒ–

1. **æ•°æ®åº“ä¼˜åŒ–**
```typescript
// ä½¿ç”¨ç´¢å¼•
CREATE INDEX idx_user_email ON users(email);

// æŸ¥è¯¢ä¼˜åŒ–
const users = await prisma.user.findMany({
  select: {
    id: true,
    name: true,
    email: true
  },
  where: {
    active: true
  },
  take: 100
});
```

2. **ç¼“å­˜ç­–ç•¥**
```typescript
// Redisç¼“å­˜
async function getUser(id: string): Promise<User> {
  const cacheKey = `user:${id}`;
  
  // å°è¯•ä»ç¼“å­˜è·å–
  const cached = await redis.get(cacheKey);
  if (cached) {
    return JSON.parse(cached);
  }
  
  // ä»æ•°æ®åº“è·å–
  const user = await prisma.user.findUnique({ where: { id } });
  
  // å†™å…¥ç¼“å­˜
  await redis.setex(cacheKey, 3600, JSON.stringify(user));
  
  return user;
}
```



## å®‰å…¨è€ƒè™‘

### å®‰å…¨è€ƒè™‘

#### è®¤è¯ä¸æˆæƒ

1. **JWTè®¤è¯**
```typescript
// ç”ŸæˆJWTä»¤ç‰Œ
const token = jwt.sign(
  { userId: user.id, role: user.role },
  process.env.JWT_SECRET,
  { expiresIn: '24h' }
);

// éªŒè¯JWTä»¤ç‰Œ
const decoded = jwt.verify(token, process.env.JWT_SECRET);
```

2. **RBACæˆæƒ**
```typescript
// è§’è‰²æƒé™æ£€æŸ¥
function checkPermission(user: User, resource: string, action: string): boolean {
  const permissions = rolePermissions[user.role];
  return permissions.some(p => 
    p.resource === resource && p.actions.includes(action)
  );
}
```

#### æ•°æ®ä¿æŠ¤

1. **è¾“å…¥éªŒè¯**
```typescript
// ä½¿ç”¨Zodè¿›è¡Œè¾“å…¥éªŒè¯
const createUserSchema = z.object({
  email: z.string().email(),
  password: z.string().min(8).regex(/[A-Z]/),
  name: z.string().min(2)
});

const validated = createUserSchema.parse(input);
```

2. **æ•°æ®åŠ å¯†**
```typescript
// ä½¿ç”¨bcryptåŠ å¯†å¯†ç 
const hashedPassword = await bcrypt.hash(password, 10);

// éªŒè¯å¯†ç 
const isValid = await bcrypt.compare(password, hashedPassword);
```

#### å®‰å…¨å¤´é…ç½®

```typescript
// Expresså®‰å…¨å¤´é…ç½®
app.use(helmet());
app.use(cors({
  origin: process.env.ALLOWED_ORIGINS?.split(','),
  credentials: true
}));
```



## ç›‘æ§å‘Šè­¦

### ç›‘æ§å‘Šè­¦

#### ç›‘æ§æŒ‡æ ‡

1. **ç³»ç»ŸæŒ‡æ ‡**
- CPUä½¿ç”¨ç‡
- å†…å­˜ä½¿ç”¨ç‡
- ç£ç›˜ä½¿ç”¨ç‡
- ç½‘ç»œI/O

2. **åº”ç”¨æŒ‡æ ‡**
- è¯·æ±‚é‡(RPS)
- å“åº”æ—¶é—´
- é”™è¯¯ç‡
- å¹¶å‘ç”¨æˆ·æ•°

3. **ä¸šåŠ¡æŒ‡æ ‡**
- ç”¨æˆ·æ³¨å†Œæ•°
- è®¢å•åˆ›å»ºæ•°
- æ”¯ä»˜æˆåŠŸç‡
- ç”¨æˆ·æ´»è·ƒåº¦

#### ç›‘æ§å·¥å…·

```typescript
// PrometheusæŒ‡æ ‡æ”¶é›†
import { Counter, Histogram, Gauge } from 'prom-client';

const requestCounter = new Counter({
  name: 'http_requests_total',
  help: 'Total number of HTTP requests',
  labelNames: ['method', 'route', 'status']
});

const responseTime = new Histogram({
  name: 'http_request_duration_seconds',
  help: 'HTTP request duration in seconds',
  labelNames: ['method', 'route']
});

// ä½¿ç”¨ä¸­é—´ä»¶è®°å½•æŒ‡æ ‡
app.use((req, res, next) => {
  const start = Date.now();
  
  res.on('finish', () => {
    const duration = (Date.now() - start) / 1000;
    requestCounter.inc({
      method: req.method,
      route: req.route?.path || req.path,
      status: res.statusCode
    });
    responseTime.observe({
      method: req.method,
      route: req.route?.path || req.path
    }, duration);
  });
  
  next();
});
```

#### å‘Šè­¦è§„åˆ™

```yaml
groups:
- name: api_alerts
  rules:
  - alert: HighErrorRate
    expr: rate(http_requests_total{status=~"5.."}[5m]) > 0.05
    for: 5m
    labels:
      severity: critical
    annotations:
      summary: "APIé”™è¯¯ç‡è¿‡é«˜"
      description: "5åˆ†é’Ÿå†…é”™è¯¯ç‡è¶…è¿‡5%"
  
  - alert: HighResponseTime
    expr: histogram_quantile(0.95, http_request_duration_seconds) > 1
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: "APIå“åº”æ—¶é—´è¿‡é•¿"
      description: "95%åˆ†ä½å“åº”æ—¶é—´è¶…è¿‡1ç§’"
```



## æœ€ä½³å®è·µ

### æœ€ä½³å®è·µ

#### ä»£ç è§„èŒƒ

1. **å‘½åè§„èŒƒ**
```typescript
// å˜é‡ï¼šcamelCase
const userName = 'John';

// å¸¸é‡ï¼šUPPER_SNAKE_CASE
const MAX_RETRY_COUNT = 3;

// ç±»ï¼šPascalCase
class UserService { }

// æ¥å£ï¼šPascalCaseï¼Œå‰ç¼€Iï¼ˆå¯é€‰ï¼‰
interface IUserService { }
```

2. **æ³¨é‡Šè§„èŒƒ**
```typescript
/**
 * åˆ›å»ºç”¨æˆ·
 * @param email - ç”¨æˆ·é‚®ç®±
 * @param password - ç”¨æˆ·å¯†ç 
 * @returns åˆ›å»ºçš„ç”¨æˆ·å¯¹è±¡
 * @throws {Error} å½“é‚®ç®±å·²å­˜åœ¨æ—¶æŠ›å‡ºé”™è¯¯
 */
async function createUser(
  email: string, 
  password: string
): Promise<User> {
  // å®ç°
}
```

#### é”™è¯¯å¤„ç†

```typescript
// ç»Ÿä¸€é”™è¯¯å¤„ç†
class AppError extends Error {
  constructor(
    public statusCode: number,
    public message: string,
    public isOperational = true
  ) {
    super(message);
    this.name = this.constructor.name;
    Error.captureStackTrace(this, this.constructor);
  }
}

// ä½¿ç”¨é”™è¯¯å¤„ç†ä¸­é—´ä»¶
app.use((err: Error, req: Request, res: Response, next: NextFunction) => {
  if (err instanceof AppError) {
    return res.status(err.statusCode).json({
      success: false,
      error: err.message
    });
  }
  
  // è®°å½•æœªé¢„æœŸçš„é”™è¯¯
  logger.error('Unexpected error:', err);
  
  return res.status(500).json({
    success: false,
    error: 'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯'
  });
});
```

#### æ—¥å¿—è®°å½•

```typescript
// ç»“æ„åŒ–æ—¥å¿—
import winston from 'winston';

const logger = winston.createLogger({
  level: 'info',
  format: winston.format.combine(
    winston.format.timestamp(),
    winston.format.json()
  ),
  transports: [
    new winston.transports.File({ filename: 'error.log', level: 'error' }),
    new winston.transports.File({ filename: 'combined.log' })
  ]
});

// ä½¿ç”¨æ—¥å¿—
logger.info('User created', { userId: user.id, email: user.email });
logger.error('Database connection failed', { error: error.message });
```


## ç›¸å…³æ–‡æ¡£

- [ğŸ”– YYCÂ³ CI/CD æµæ°´çº¿æ¶æ„æ–‡æ¡£](YYC3-Cater-éƒ¨ç½²å‘å¸ƒ/æ¶æ„ç±»/02-YYC3-Cater--æ¶æ„ç±»-CI_CDæµæ°´çº¿æ¶æ„æ–‡æ¡£.md) - YYC3-Cater-éƒ¨ç½²å‘å¸ƒ/æ¶æ„ç±»
- [ğŸ”– YYCÂ³ éƒ¨ç½²æ¶æ„å®æ–½æ–‡æ¡£](YYC3-Cater-éƒ¨ç½²å‘å¸ƒ/æ¶æ„ç±»/01-YYC3-Cater--æ¶æ„ç±»-éƒ¨ç½²æ¶æ„å®æ–½æ–‡æ¡£.md) - YYC3-Cater-éƒ¨ç½²å‘å¸ƒ/æ¶æ„ç±»
- [YYCÂ³æ™ºæ¢æœåŠ¡åŒ–å¹³å° - é£é™©ç®¡ç†ä¸è´¨é‡ä¿éšœè®¡åˆ’](YYC3-Cater-éƒ¨ç½²å‘å¸ƒ/æ¶æ„ç±»/05-YYC3-Cater--æ¶æ„ç±»-é£é™©ç®¡ç†ä¸è´¨é‡ä¿éšœè®¡åˆ’.md) - YYC3-Cater-éƒ¨ç½²å‘å¸ƒ/æ¶æ„ç±»
- [ğŸ”– YYCÂ³ ç°åº¦å‘å¸ƒæ¶æ„è®¾è®¡æ–‡æ¡£](YYC3-Cater-éƒ¨ç½²å‘å¸ƒ/æ¶æ„ç±»/04-YYC3-Cater--æ¶æ„ç±»-ç°åº¦å‘å¸ƒæ¶æ„è®¾è®¡æ–‡æ¡£.md) - YYC3-Cater-éƒ¨ç½²å‘å¸ƒ/æ¶æ„ç±»
- [ğŸ”– YYCÂ³ Dockerå®¹å™¨åŒ–éƒ¨ç½²æŠ€å·§](YYC3-Cater-éƒ¨ç½²å‘å¸ƒ/æŠ€å·§ç±»/01-YYC3-Cater--æŠ€å·§ç±»-Dockerå®¹å™¨åŒ–éƒ¨ç½²æŠ€å·§.md) - YYC3-Cater-éƒ¨ç½²å‘å¸ƒ/æŠ€å·§ç±»
